<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="zh-cn" http-equiv="content-language"/>
<meta content="我们这个课程的系统是怎么搭建起来的？" name="description"/>
<link href="/static/favicon.png" rel="icon"/>
<title>我们这个课程的系统是怎么搭建起来的？ </title>
<link href="/static/index.css" rel="stylesheet"/>
<link href="/static/highlight.min.css" rel="stylesheet"/>
<script src="/static/highlight.min.js"></script>
<meta content="Hexo 4.2.0" name="generator"/>
<script data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" defer="" src="https://umami.lianglianglee.com/script.js"></script>
</head>
<body>
<div class="book-container">
<div class="book-sidebar">
<div class="book-brand">
<a href="/">
<img src="/static/favicon.png"/>
<span>技术文章摘抄</span>
</a>
</div>
<div class="book-menu uncollapsible">
<ul class="uncollapsible">
<li><a class="current-tab" href="/">首页</a></li>
<li><a href="../">上一级</a></li>
</ul>
<ul class="uncollapsible">
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/00%20%e5%bc%80%e7%af%87%e8%af%8d%20%e6%89%93%e7%a0%b4%e5%9b%9b%e5%a4%a7%e8%ae%a4%e7%9f%a5%e5%b1%80%e9%99%90%ef%bc%8c%e8%bf%9b%e9%98%b6%e9%ab%98%e7%ba%a7%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%b8%88.md.html" id="00 开篇词 打破四大认知局限，进阶高级性能工程师.md.html">00 开篇词 打破四大认知局限，进阶高级性能工程师.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/01%20%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%ef%bc%9a%e4%b8%ba%e4%bb%80%e4%b9%88%e5%be%88%e5%a4%9a%e6%80%a7%e8%83%bd%e6%b5%8b%e8%af%95%e4%ba%ba%e5%91%98%e6%97%a0%e6%b3%95%e5%af%b9%e6%80%a7%e8%83%bd%e7%bb%93%e6%9e%9c%e8%b4%9f%e8%b4%a3%ef%bc%9f.md.html" id="01 性能工程：为什么很多性能测试人员无法对性能结果负责？.md.html">01 性能工程：为什么很多性能测试人员无法对性能结果负责？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/02%20%e5%85%b3%e9%94%ae%e6%a6%82%e5%bf%b5%ef%bc%9a%e6%80%a7%e8%83%bd%e6%8c%87%e6%a0%87%e5%92%8c%e5%9c%ba%e6%99%af%e7%9a%84%e7%a1%ae%e5%ae%9a.md.html" id="02 关键概念：性能指标和场景的确定.md.html">02 关键概念：性能指标和场景的确定.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/03%20%e6%a0%b8%e5%bf%83%e5%88%86%e6%9e%90%e9%80%bb%e8%be%91%ef%bc%9a%e6%89%80%e6%9c%89%e7%9a%84%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90%ef%bc%8c%e9%9d%a0%e8%bf%99%e4%b8%83%e6%ad%a5%e9%83%bd%e8%83%bd%e6%90%9e%e5%ae%9a.md.html" id="03 核心分析逻辑：所有的性能分析，靠这七步都能搞定.md.html">03 核心分析逻辑：所有的性能分析，靠这七步都能搞定.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/04%20%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90%e5%86%b3%e7%ad%96%e6%a0%91%e5%92%8c%e6%9f%a5%e6%89%be%e7%93%b6%e9%a2%88%e8%af%81%e6%8d%ae%e9%93%be%ef%bc%9f.md.html" id="04 如何构建性能分析决策树和查找瓶颈证据链？.md.html">04 如何构建性能分析决策树和查找瓶颈证据链？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/05%20%e6%80%a7%e8%83%bd%e6%96%b9%e6%a1%88%ef%bc%9a%e4%bd%a0%e7%9a%84%e6%96%b9%e6%a1%88%e6%98%af%e5%90%a6%e8%bf%98%e5%81%9c%e7%95%99%e5%9c%a8%e5%bd%a2%e5%bc%8f%e4%b8%8a%ef%bc%9f.md.html" id="05 性能方案：你的方案是否还停留在形式上？.md.html">05 性能方案：你的方案是否还停留在形式上？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/06%20%e5%a6%82%e4%bd%95%e6%8a%bd%e5%8f%96%e5%87%ba%e7%ac%a6%e5%90%88%e7%9c%9f%e5%ae%9e%e4%b8%9a%e5%8a%a1%e5%9c%ba%e6%99%af%e7%9a%84%e4%b8%9a%e5%8a%a1%e6%a8%a1%e5%9e%8b%ef%bc%9f.md.html" id="06 如何抽取出符合真实业务场景的业务模型？.md.html">06 如何抽取出符合真实业务场景的业务模型？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/07%20%e6%80%a7%e8%83%bd%e5%9c%ba%e6%99%af%e7%9a%84%e6%95%b0%e6%8d%ae%e5%88%b0%e5%ba%95%e5%ba%94%e8%af%a5%e5%81%9a%e6%88%90%e4%bb%80%e4%b9%88%e6%a0%b7%e5%ad%90%ef%bc%9f.md.html" id="07 性能场景的数据到底应该做成什么样子？.md.html">07 性能场景的数据到底应该做成什么样子？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/08%20%e5%b9%b6%e5%8f%91%e3%80%81%e5%9c%a8%e7%ba%bf%e5%92%8cTPS%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e4%b9%88%e5%85%b3%e7%b3%bb%ef%bc%9f.md.html" id="08 并发、在线和TPS到底是什么关系？.md.html">08 并发、在线和TPS到底是什么关系？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/09%20%e5%a6%82%e4%bd%95%e8%ae%be%e8%ae%a1%e5%85%a8%e5%b1%80%e5%92%8c%e5%ae%9a%e5%90%91%e7%9b%91%e6%8e%a7%e7%ad%96%e7%95%a5%ef%bc%9f.md.html" id="09 如何设计全局和定向监控策略？.md.html">09 如何设计全局和定向监控策略？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/10%20%e8%ae%be%e8%ae%a1%e5%9f%ba%e5%87%86%e5%9c%ba%e6%99%af%e9%9c%80%e8%a6%81%e6%b3%a8%e6%84%8f%e5%93%aa%e4%ba%9b%e5%85%b3%e9%94%ae%e7%82%b9%ef%bc%9f.md.html" id="10 设计基准场景需要注意哪些关键点？.md.html">10 设计基准场景需要注意哪些关键点？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/11%20%e6%89%93%e5%bc%80%e9%a6%96%e9%a1%b5%e4%b9%8b%e4%b8%80%ef%bc%9a%e4%b8%80%e4%b8%aa%e6%a1%88%e4%be%8b%ef%bc%8c%e5%b8%a6%e4%bd%a0%e6%90%9e%e6%87%82%e5%9f%ba%e7%a1%80%e7%a1%ac%e4%bb%b6%e8%ae%be%e6%96%bd%e7%9a%84%e6%80%a7%e8%83%bd%e9%97%ae%e9%a2%98.md.html" id="11 打开首页之一：一个案例，带你搞懂基础硬件设施的性能问题.md.html">11 打开首页之一：一个案例，带你搞懂基础硬件设施的性能问题.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/12%20%e6%89%93%e5%bc%80%e9%a6%96%e9%a1%b5%e4%b9%8b%e4%ba%8c%ef%bc%9a%e5%a6%82%e4%bd%95%e5%b9%b3%e8%a1%a1%e5%88%a9%e7%94%a8%e7%a1%ac%e4%bb%b6%e8%b5%84%e6%ba%90%ef%bc%9f.md.html" id="12 打开首页之二：如何平衡利用硬件资源？.md.html">12 打开首页之二：如何平衡利用硬件资源？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/13%20%e7%94%a8%e6%88%b7%e7%99%bb%e5%bd%95%ef%bc%9a%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad%e7%ba%bf%e7%a8%8b%e4%b8%ad%e7%9a%84Block%e5%8e%9f%e5%9b%a0%ef%bc%9f.md.html" id="13 用户登录：怎么判断线程中的Block原因？.md.html">13 用户登录：怎么判断线程中的Block原因？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/14%20%e7%94%a8%e6%88%b7%e4%bf%a1%e6%81%af%e6%9f%a5%e8%af%a2%ef%bc%9a%e5%a6%82%e4%bd%95%e8%a7%a3%e5%86%b3%e7%bd%91%e7%bb%9c%e8%bd%af%e4%b8%ad%e6%96%ad%e7%93%b6%e9%a2%88%e9%97%ae%e9%a2%98%ef%bc%9f.md.html" id="14 用户信息查询：如何解决网络软中断瓶颈问题？.md.html">14 用户信息查询：如何解决网络软中断瓶颈问题？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/15%20%e6%9f%a5%e8%af%a2%e5%95%86%e5%93%81%ef%bc%9a%e8%b5%84%e6%ba%90%e4%b8%8d%e8%b6%b3%e6%9c%89%e5%93%aa%e4%ba%9b%e6%80%a7%e8%83%bd%e8%a1%a8%e7%8e%b0%ef%bc%9f.md.html" id="15 查询商品：资源不足有哪些性能表现？.md.html">15 查询商品：资源不足有哪些性能表现？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/16%20%e5%95%86%e5%93%81%e5%8a%a0%e5%85%a5%e8%b4%ad%e7%89%a9%e8%bd%a6%ef%bc%9aSQL%e4%bc%98%e5%8c%96%e5%92%8c%e5%8e%8b%e5%8a%9b%e5%b7%a5%e5%85%b7%e4%b8%ad%e7%9a%84%e5%8f%82%e6%95%b0%e5%88%86%e6%9e%90.md.html" id="16 商品加入购物车：SQL优化和压力工具中的参数分析.md.html">16 商品加入购物车：SQL优化和压力工具中的参数分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/17%20%e6%9f%a5%e8%af%a2%e8%b4%ad%e7%89%a9%e8%bd%a6%ef%bc%9a%e4%b8%ba%e4%bb%80%e4%b9%88%e9%93%ba%e5%ba%95%e5%8f%82%e6%95%b0%e4%b8%80%e5%ae%9a%e8%a6%81%e7%ac%a6%e5%90%88%e7%9c%9f%e5%ae%9e%e4%b8%9a%e5%8a%a1%e7%89%b9%e6%80%a7%ef%bc%9f.md.html" id="17 查询购物车：为什么铺底参数一定要符合真实业务特性？.md.html">17 查询购物车：为什么铺底参数一定要符合真实业务特性？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/18%20%e8%b4%ad%e7%89%a9%e8%bd%a6%e4%bf%a1%e6%81%af%e7%a1%ae%e5%ae%9a%e8%ae%a2%e5%8d%95%ef%bc%9a%e4%b8%ba%e4%bb%80%e4%b9%88%e5%8a%a8%e6%80%81%e5%8f%82%e6%95%b0%e5%8c%96%e9%80%bb%e8%be%91%e9%9d%9e%e5%b8%b8%e9%87%8d%e8%a6%81%ef%bc%9f.md.html" id="18 购物车信息确定订单：为什么动态参数化逻辑非常重要？.md.html">18 购物车信息确定订单：为什么动态参数化逻辑非常重要？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/19%20%e7%94%9f%e6%88%90%e8%ae%a2%e5%8d%95%e4%bf%a1%e6%81%af%e4%b9%8b%e4%b8%80%ef%bc%9a%e5%ba%94%e7%94%a8JDBC%e6%b1%a0%e4%bc%98%e5%8c%96%e5%92%8c%e5%86%85%e5%ad%98%e6%ba%a2%e5%87%ba%e5%88%86%e6%9e%90.md.html" id="19 生成订单信息之一：应用JDBC池优化和内存溢出分析.md.html">19 生成订单信息之一：应用JDBC池优化和内存溢出分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/20%20%e7%94%9f%e6%88%90%e8%ae%a2%e5%8d%95%e4%bf%a1%e6%81%af%e4%b9%8b%e4%ba%8c%ef%bc%9a%e4%b8%9a%e5%8a%a1%e9%80%bb%e8%be%91%e5%a4%8d%e6%9d%82%ef%bc%8c%e6%80%8e%e4%b9%88%e5%81%9a%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%9f.md.html" id="20 生成订单信息之二：业务逻辑复杂，怎么做性能优化？.md.html">20 生成订单信息之二：业务逻辑复杂，怎么做性能优化？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/21%20%e6%94%af%e4%bb%98%e5%89%8d%e6%9f%a5%e8%af%a2%e8%ae%a2%e5%8d%95%e5%88%97%e8%a1%a8%ef%bc%9a%e5%a6%82%e4%bd%95%e5%88%86%e6%9e%90%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e5%9b%ba%e5%ae%9a%e7%9a%84%e6%8a%80%e6%9c%af%e7%bb%84%e4%bb%b6%ef%bc%9f.md.html" id="21 支付前查询订单列表：如何分析优化一个固定的技术组件？.md.html">21 支付前查询订单列表：如何分析优化一个固定的技术组件？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/22%20%e6%94%af%e4%bb%98%e8%ae%a2%e5%8d%95%e4%bf%a1%e6%81%af%ef%bc%9a%e5%a6%82%e4%bd%95%e9%ab%98%e6%95%88%e8%a7%a3%e5%86%b3for%e5%be%aa%e7%8e%af%e4%ba%a7%e7%94%9f%e7%9a%84%e5%86%85%e5%ad%98%e6%ba%a2%e5%87%ba%ef%bc%9f.md.html" id="22 支付订单信息：如何高效解决for循环产生的内存溢出？.md.html">22 支付订单信息：如何高效解决for循环产生的内存溢出？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/23%20%e5%86%b3%e5%ae%9a%e5%ae%b9%e9%87%8f%e5%9c%ba%e6%99%af%e6%88%90%e8%b4%a5%e7%9a%84%e5%85%b3%e9%94%ae%e5%9b%a0%e7%b4%a0%e6%9c%89%e5%93%aa%e4%ba%9b%ef%bc%9f.md.html" id="23 决定容量场景成败的关键因素有哪些？.md.html">23 决定容量场景成败的关键因素有哪些？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/24%20%e5%ae%b9%e9%87%8f%e5%9c%ba%e6%99%af%e4%b9%8b%e4%b8%80%ef%bc%9a%e7%b4%a2%e5%bc%95%e4%bc%98%e5%8c%96%e5%92%8cKubernetes%e8%b5%84%e6%ba%90%e5%88%86%e9%85%8d%e4%b8%8d%e5%9d%87%e8%a1%a1%e6%80%8e%e4%b9%88%e5%8a%9e%ef%bc%9f.md.html" id="24 容量场景之一：索引优化和Kubernetes资源分配不均衡怎么办？.md.html">24 容量场景之一：索引优化和Kubernetes资源分配不均衡怎么办？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/25%20%e5%ae%b9%e9%87%8f%e5%9c%ba%e6%99%af%e4%b9%8b%e4%ba%8c%ef%bc%9a%e7%bc%93%e5%ad%98%e5%af%b9%e6%80%a7%e8%83%bd%e4%bc%9a%e6%9c%89%e4%bb%80%e4%b9%88%e6%a0%b7%e7%9a%84%e5%bd%b1%e5%93%8d%ef%bc%9f.md.html" id="25 容量场景之二：缓存对性能会有什么样的影响？.md.html">25 容量场景之二：缓存对性能会有什么样的影响？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/26%20%e7%a8%b3%e5%ae%9a%e6%80%a7%e5%9c%ba%e6%99%af%e4%b9%8b%e4%b8%80%ef%bc%9a%e6%80%8e%e6%a0%b7%e6%90%9e%e5%ae%9a%e4%b8%9a%e5%8a%a1%e7%a7%af%e7%b4%af%e9%87%8f%e4%ba%a7%e7%94%9f%e7%9a%84%e7%93%b6%e9%a2%88%e9%97%ae%e9%a2%98%ef%bc%9f.md.html" id="26 稳定性场景之一：怎样搞定业务积累量产生的瓶颈问题？.md.html">26 稳定性场景之一：怎样搞定业务积累量产生的瓶颈问题？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/27%20%e7%a8%b3%e5%ae%9a%e6%80%a7%e5%9c%ba%e6%99%af%e4%b9%8b%e4%ba%8c%ef%bc%9a%e6%80%8e%e6%a0%b7%e6%90%9e%e5%ae%9a%e7%a3%81%e7%9b%98%e4%b8%8d%e8%b6%b3%e4%ba%a7%e7%94%9f%e7%9a%84%e7%93%b6%e9%a2%88%e9%97%ae%e9%a2%98%ef%bc%9f.md.html" id="27 稳定性场景之二：怎样搞定磁盘不足产生的瓶颈问题？.md.html">27 稳定性场景之二：怎样搞定磁盘不足产生的瓶颈问题？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/28%20%e5%a6%82%e4%bd%95%e7%a1%ae%e5%ae%9a%e5%bc%82%e5%b8%b8%e5%9c%ba%e6%99%af%e7%9a%84%e8%8c%83%e5%9b%b4%e5%92%8c%e8%ae%be%e8%ae%a1%e9%80%bb%e8%be%91%ef%bc%9f.md.html" id="28 如何确定异常场景的范围和设计逻辑？.md.html">28 如何确定异常场景的范围和设计逻辑？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/29%20%e5%bc%82%e5%b8%b8%e5%9c%ba%e6%99%af%ef%bc%9a%e5%a6%82%e4%bd%95%e6%a8%a1%e6%8b%9f%e4%b8%8d%e5%90%8c%e7%bb%84%e4%bb%b6%e5%b1%82%e7%ba%a7%e7%9a%84%e5%bc%82%e5%b8%b8%ef%bc%9f.md.html" id="29 异常场景：如何模拟不同组件层级的异常？.md.html">29 异常场景：如何模拟不同组件层级的异常？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/30%20%e5%a6%82%e4%bd%95%e7%a1%ae%e5%ae%9a%e7%94%9f%e4%ba%a7%e7%b3%bb%e7%bb%9f%e9%85%8d%e7%bd%ae%ef%bc%9f.md.html" id="30 如何确定生产系统配置？.md.html">30 如何确定生产系统配置？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/31%20%e6%80%8e%e4%b9%88%e5%86%99%e5%87%ba%e6%9c%89%e4%bb%b7%e5%80%bc%e7%9a%84%e6%80%a7%e8%83%bd%e6%8a%a5%e5%91%8a%ef%bc%9f.md.html" id="31 怎么写出有价值的性能报告？.md.html">31 怎么写出有价值的性能报告？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/%e6%88%91%e4%bb%ac%e8%bf%99%e4%b8%aa%e8%af%be%e7%a8%8b%e7%9a%84%e7%b3%bb%e7%bb%9f%e6%98%af%e6%80%8e%e4%b9%88%e6%90%ad%e5%bb%ba%e8%b5%b7%e6%9d%a5%e7%9a%84%ef%bc%9f.md.html" id="我们这个课程的系统是怎么搭建起来的？.md.html">我们这个课程的系统是怎么搭建起来的？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e9%ab%98%e6%a5%bc%e7%9a%84%e6%80%a7%e8%83%bd%e5%b7%a5%e7%a8%8b%e5%ae%9e%e6%88%98%e8%af%be/%e7%bb%93%e6%9d%9f%e8%af%ad%20%e5%81%9a%e7%9c%9f%e6%ad%a3%e7%9a%84%e6%80%a7%e8%83%bd%e9%a1%b9%e7%9b%ae.md.html" id="结束语 做真正的性能项目.md.html">结束语 做真正的性能项目.md.html</a>
</li>
<li><a href="/assets/捐赠.md.html">捐赠</a></li>
</ul>
</div>
</div>
<div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseleave="remove_inner()" onmouseover="add_inner()">
<div class="sidebar-toggle-inner"></div>
</div>
<div class="off-canvas-content">
<div class="columns">
<div class="column col-12 col-lg-12">
<div class="book-navbar">
<header class="navbar">
<section class="navbar-section">
<a onclick="open_sidebar()">
<i class="icon icon-menu"></i>
</a>
</section>
</header>
</div>
<div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
<div class="book-post">
<div align="center">因收到Google相关通知，网站将会择期关闭。<a href="https://lumendatabase.org/notices/44265620" target="_blank">相关通知内容</a><hr/></div>
<p align="center" id="tip"></p>
<h1 class="title" data-id="我们这个课程的系统是怎么搭建起来的？" id="title">我们这个课程的系统是怎么搭建起来的？</h1>
<div><p>你好，我是高楼。</p>
<p>在我们这个课程里，为了让你更好地理解我的性能工程理念，我专门搭建了一个完整的系统，我们所有的内容都是基于这个系统展开的。</p>
<p>自课程更新以来，有不少同学问我要这个系统的搭建教程，想自己试一试。因此，我梳理了一版搭建教程，希望能帮到你。</p>
<p>由于整个系统相对复杂，有很多需要考虑、部署的细节，所以这节课的内容会比较长。下面这张图是我们这节课的目录，你可以整体了解一下，然后对应这张目录图，来学习具体的搭建步骤，以免迷失方向。</p>
<p><img alt="" src="assets/5d2698a07b0947bc967a771f340f1058.jpg"/></p>
<h2 id="一-物理服务器">一. 物理服务器</h2>
<h3 id="1-服务器规划">1. 服务器规划</h3>
<p>在这个系统中，我们主要用到了四台服务器，下面是具体的硬件配置：</p>
<p><img alt="" src="assets/96c83c677a2f4b4e92c992d7358fa0a4.jpg"/></p>
<p>我们可以看到，当前服务器在应用中使用的资源总共是 64C 的 CPU 资源，以及 128 G 的内存资源。由于 NFS (网络存储)服务器不用在应用中，我们不计算在内。</p>
<p>因为单台机器的硬件资源相对较多，所以，在后续的工作中，我们将这些物理机化为虚拟机使用，以方便应用的管理。</p>
<p>在成本上，所有物理机的费用加在一起大概八万元左右，这其中还包括交换机、机柜、网线等各类杂七杂八的费用。</p>
<h3 id="2-服务器搭建">2. 服务器搭建</h3>
<p>目前，行业内主流的基于 x86 架构的 Linux 系统，无非是 CentOS 和 Ubuntu。在我们这个项目中，我选择 CentOS 系列来搭建 Linux 系统，主要是考虑到系统的稳定性。CentOS 来自 Redhat 商业版本的重新编译，它在稳定性、系统优化以及兼容性方面，具有比较完善的测试和发版流程。</p>
<p>在 CentOS 7 之后的版本中，CentOS 的内核换成了 Linux 3.x，因此，我们这个课程的分析都是基于 Linux 3.x 这个内核版本展开的。</p>
<p>在搭建过程中，我们给每台服务器都安装了 CentOS 7.8 的操作系统。如果你是新手，我建议你使用带 GUI 桌面的系统，方便后续操作和管理虚拟机。具体的操作系统安装步骤，你可以参考这个链接来部署： <a href="https://blog.csdn.net/zuozewei/article/details/84951690" target="_blank">HP 服务器安装 CentOS 7</a> 。</p>
<h2 id="二-虚拟化">二. 虚拟化</h2>
<h3 id="1-虚拟机规划">1. 虚拟机规划</h3>
<p>我们接着来看虚拟机规划。我们部署了至少五台虚机，并且把虚拟机类型分为两种主机节点类型：</p>
<ul>
<li>普通节点：</li>
</ul>
<p>普通节点用来做非被测系统使用，比如压力机、管理平台等。我们可以选择采用 Docker、二进制等方式来部署。</p>
<ul>
<li>Kubernetes节点：</li>
</ul>
<p>Kubernetes节点用于部署项目的应用服务，包括 mall-admin、mall-portal、mall-gateway、mall-member、mall-cart 等应用服务，还包括 SkyWalking、Nacos 等基础组件。这些都采用 Kubernetes的方式来部署。</p>
<p>具体的节点规划，你可以参考这张表：</p>
<p><img alt="" src="assets/0ec9707724454a35bed479043e560325.jpg"/></p>
<p>在这里，我们规划了三个Kubernetes控制节点，这是为后续的高可用方案准备的。如果你计划搭建单 Master 集群，只需要一个Kubernetes控制节点即可。至于Kubernetes计算节点，结合前面的节点规划，我们在这里配置 9 个 worker 节点，其他的节点根据自己的需求灵活扩展。</p>
<h3 id="2-虚机安装">2. 虚机安装</h3>
<p>到了安装虚拟机这一步，我们最终选择以 KVM 为主的方案。这主要考虑到，KVM 是目前比较成熟的开源虚拟化平台，在 2006 年被写入到 Linux 内核中。并且在 RedHat 6 以后，RedHat 开始转向支持 KVM，而非之前大力推广的 Xen 虚拟化方案，随后 Intel 也开始全面支持 KVM。KVM 相比较于 Xen，更小，更轻量级，也更方便管理。</p>
<p>在项目搭建之初，我们也尝试过用 OpenStack 做底层，但是 OpenStack 部署起来不仅繁杂，而且坑也多，需要投入大量的时间成本。我们当时在分析 OpenStack 本身的问题上花费了很多时间，对于我们的这个系统来说，这是没有必要的。</p>
<p>所以，我们最终选择用 KVM 来做虚拟化，它的技术相对成熟，操作又比较简单。</p>
<p>你可能会有疑问，为什么不用 VMware 呢？我们知道，在虚拟化平台中，VMware 在 IO 和稳定性方面都算是目前最优的一个方案了，也能满足我们的需求。不过，它是一款商业软件，授权比较昂贵，这是我们这个项目不得不放弃的一个原因。当然，如果你的项目有充足的预算， VMware 是一个不错的选择。</p>
<p>在安装之前，你可以大概了解一下 KVM 性能、热迁移、稳定性、应用移植、搭建等方面的注意事项，做为知识的扩展补充。对性能分析来说，我们要关注一下KVM的优化重点：<a href="https://mp.weixin.qq.com/s/L-jNlwYKFWgoKX6L5ffz5A" target="_blank">关于KVM 虚拟化注意的二三事整理</a></p>
<p>至于 KVM 的安装和使用，你可以参考这个链接里的内容：<a href="https://mp.weixin.qq.com/s/UluDn0jG-uYZqpIsIXzKAg" target="_blank">Linux KVM 安装使用手册</a>。</p>
<h2 id="三-kubernetes-集群">三. Kubernetes 集群</h2>
<h3 id="1-计算资源">1. 计算资源</h3>
<p>关于集群计算资源，你可以参考这张表：</p>
<p><img alt="" src="assets/56ee45f0a23e4957955fd5286ad16d7b.jpg"/></p>
<p>我们在做计算资源规划的时候，通常需要考虑不同的应用场景：</p>
<ul>
<li>传统虚拟化技术的 I/O 损耗较大，对于 I/O 密集型应用，物理机相比传统虚拟机（像VMware的传统虚拟化做出来的虚拟机)有更好的性能表现；</li>
<li>在物理机上部署应用，有更少的额外资源开销（如虚拟化管理、虚拟机操作系统等），并且可以有更高的部署密度，来降低基础设施成本；</li>
<li>在物理机上可以更加灵活地选择网络、存储等设备和软件应用生态。</li>
</ul>
<p>如果从实际生产环境考虑，一般而言建议：</p>
<ul>
<li>对性能极其敏感的应用，如高性能计算，物理机是较好的选择；</li>
<li>云主机支持热迁移，可以有效降低运维成本；</li>
<li>在工作实践中，我们会为 Kubernetes 集群划分静态资源池和弹性资源池。通常而言，固定资源池可以根据需要选择物理机或者云主机实例；弹性资源池则可以根据应用负载，使用合适规格的云主机实例来优化成本，避免资源浪费，同时提升弹性供给保障。</li>
</ul>
<p>由于我们这个系统只是课程的示例项目，为了尽可能压榨服务器资源，节省服务器成本，我们选择了自行准备虚机的方案，这样可以充分使用硬件资源。</p>
<h3 id="2-集群搭建">2. 集群搭建</h3>
<p>关于集群搭建，我们的节点规划如下：</p>
<p><img alt="" src="assets/2ae629cd7b714740862dad0975150be8.jpg"/></p>
<p>关于集群搭建的具体步骤，你可以按照下面这两个文档进行部署：</p>
<ul>
<li>单 Master 集群：<a href="https://mp.weixin.qq.com/s/eQOMt3dz1P2JwezDaoZGzg" target="_blank">使用 kubeadm 安装单master kubernetes 集群（脚本版）</a></li>
<li>高可用方案： <a href="https://mp.weixin.qq.com/s/bdq4GySQWjcIjJmn0ZD80g" target="_blank">Kubernetes 高可用集群落地二三事</a></li>
</ul>
<p>安装的负载均衡组件如下：</p>
<p><img alt="" src="assets/bc32082c9e014d9c949751d9c6b69dbb.jpg"/></p>
<p>如果你没有Kubernetes的使用基础，那么我建议学习一下这几篇入门文章：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/X2Z_a_eYq12O6yTQmRRxfw" target="_blank">Kubernetes 集群基本概念</a></li>
<li><a href="https://mp.weixin.qq.com/s/dSbCK_ms4YMoEvqp0afNZg" target="_blank">k8s入门篇-Kubernetes的基本概念和术语</a></li>
<li><a href="https://mp.weixin.qq.com/s/EPdOEwFaoc-hI27C0v3urA" target="_blank">K8s命令篇-Kubernetes工作实用命令集结号</a></li>
<li><a href="https://mp.weixin.qq.com/s/xYjR5_WZNhny_0RdjM1tpA" target="_blank">Kubernetes 集群常用操作总结</a></li>
</ul>
<h3 id="3-插件安装">3. 插件安装</h3>
<p>我们需要安装的插件主要有三种：网络插件、存储插件以及组件。</p>
<p>对于网络插件，我们选用的是目前主流的网络插件 Calico。如果你的系统有其它选型需求，那你可以参考下面这篇文章，这里我就不做赘述了。</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/H4ncgG0AqsmpPSg3ICBP3g" target="_blank">Kubernetes 网络插件（CNI）超过 10Gbit/s 的基准测试结果</a></li>
</ul>
<p>安装Calico插件的具体步骤，在前面的单 Master 集群部署文档中已有说明，你可以参考一下。</p>
<p>对于存储插件，我们选用的是 NFS 网络存储。因为 NFS 相对简单，上手快，我们只需要部署一个NFS服务，再由Kubernetes提供一个自动配置卷程序，然后通过 StoageClass 动态配置 PVC 就可以了。 而且在性能上，NFS 也能满足我们这个系统的需求。</p>
<p>只不过，NFS 并不是高可用方案。如果你是在生产环境中使用，可以考虑把 Ceph 作为存储选型方案。Ceph 是一个统一的分布式存储系统，也是高可用存储方案，并且可以提供比较好的性能、可靠性和可扩展性。但是，Ceph 部署起来更复杂些，同时维护也比 NFS 复杂。</p>
<p>我把 NFS 和 Ceph 的详细安装步骤放在这里，你如果有需要，可以学习参考。</p>
<ul>
<li>NFS： <a href="https://mp.weixin.qq.com/s/xKPAHWuLBMYuaVzpel5rUQ" target="_blank">Kubernetes 集群部署 NFS 网络存储</a></li>
<li>Ceph： <a href="https://mp.weixin.qq.com/s/tww0dPNeFNR_WaEWUh97ZQ" target="_blank">Kubernetes 集群分布式存储插件 Rook Ceph部署</a></li>
</ul>
<p>另外，不要忘了，NFS 配置中还需要这两个组件：</p>
<p><img alt="" src="assets/35f4cd8fd2d04e03a6adc5267aaa6159.jpg"/></p>
<h3 id="4-kubernetes管理平台">4. Kubernetes管理平台</h3>
<p>安装组件：</p>
<p><img alt="" src="assets/df200c5f8009448f9ce548bc0f98c4d5.jpg"/></p>
<p>Kuboard 采用的是可视化UI的方式来管理应用和组件，降低了Kubernetes集群的使用门槛。下面我们看看怎么部署 Kuboard 组件。</p>
<p>第一步，k8s 集群执行资源文件：</p>
<pre><code>kubectl apply -f https://kuboard.cn/install-script/kuboard.yaml
kubectl apply -f https://addons.kuboard.cn/metrics-server/0.3.7/metrics-server.yaml
</code></pre>
<p>第二步，把 Kuboard 安装好后，我们看一下 Kuboard 的运行状态：</p>
<pre><code>kubectl get pods -l k8s.kuboard.cn/name=kuboard -n kube-system
</code></pre>
<p>输出结果：</p>
<pre><code>NAME                       READY   STATUS        RESTARTS   AGE
kuboard-54c9c4f6cb-6lf88   1/1     Running       0          45s
</code></pre>
<p>这个结果表明 kuboard 已经成功部署了。</p>
<p>接着，我们获取管理员 Token 。这一步是为了登录访问 Kuboard，检查组件是否成功运行。</p>
<pre><code># 可在第一个 Master 节点上执行此命令
echo $(kubectl -n kube-system get secret $(kubectl -n kube-system get secret | grep kuboard-user | awk '{print $1}') -o go-template='{{.data.token}}' | base64 -d)
</code></pre>
<p>通过检查部署我们了解到，Kuboard Service 使用了 NodePort 的方式暴露服务，NodePort 为 32567。因此，我们可以按照下面这个方式访问 Kuboard：</p>
<pre><code>http://任意一个Worker节点的IP地址:32567/
</code></pre>
<p>然后，在登录中输入管理员 Token，就可以进入到 Kuboard 集群的概览页了。</p>
<p>注意，如果你使用的是阿里云、腾讯云等云服务，那么你可以在对应的安全组设置里，开放 worker 节点 32567 端口的入站访问，你也可以修改 Kuboard.yaml 文件，使用自己定义的 NodePort 端口号。</p>
<h2 id="四-依赖组件">四. 依赖组件</h2>
<h3 id="1-部署清单">1. 部署清单</h3>
<p><img alt="" src="assets/e99017b99a9c41f7a29c18b1d383392a.jpg"/></p>
<h3 id="2-安装部署">2. 安装部署</h3>
<p>对于上述依赖组件的安装部署，我整理了对应的教程放在这里，你有兴趣可以尝试一下。</p>
<p>MySQL 的二进制安装方式，在网上的教程多如牛毛，我在这里就不介绍了，如果你想知道怎么在Kubernetes下部署 MySQL，你可以参考这个链接中的详细步骤：<a href="https://mp.weixin.qq.com/s/4YSx4a2oqjrp1f6wNQgR-g" target="_blank">如何在 Kubernetes 集群中搭建一个复杂的 MySQL 数据库</a>。</p>
<p>Elasticsearch 集群的部署可以参考：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/VAlbWoSf_16-Cf5nIwEShg" target="_blank">Kubernetes Helm3 部署 Elastic</a><a href="https://mp.weixin.qq.com/s/VAlbWoSf_16-Cf5nIwEShg" target="_blank">s</a><a href="https://mp.weixin.qq.com/s/VAlbWoSf_16-Cf5nIwEShg" target="_blank">earch &amp; Kibana 7 集群</a></li>
</ul>
<p>JMeter的部署可以参考：</p>
<ul>
<li>二进制：<a href="https://mp.weixin.qq.com/s/nUNAz3Gma9fwoFNFA9Orog" target="_blank">性能工具之JMeter+InfluxDB+Grafana打造压测可视化实时监控</a></li>
<li>Kubernetes：<a href="https://mp.weixin.qq.com/s/VQl05FvzK456WAkXDM6I9Q" target="_blank">Kubernetes 下部署 Jmeter 集群</a></li>
</ul>
<p>镜像仓库 Harbor 的部署可以参考：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/_0hEWz7TUvYGASg9I3az4g" target="_blank">Kubernetes 集群仓库 harbor Helm3 部署</a></li>
</ul>
<p>Nacos 的部署可以参考：</p>
<ul>
<li>Docker 单机模式： <a href="https://nacos.io/zh-cn/docs/quick-start-docker.html" target="_blank">Nacos Docker 快速开始</a></li>
<li>Kubernetes：<a href="https://nacos.io/zh-cn/docs/use-nacos-with-kubernetes.html" target="_blank">Kubernetes Nacos</a></li>
</ul>
<p>Redis、RabbitMQ、MongoDB 单机部署的部署可以参考：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/yuAU-qWeTr4svaSI497sbQ" target="_blank">Kubernetes 集群监控 kube-prometheus 自动发现</a></li>
</ul>
<p>Logstash 的部署可以参考：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/D7Xuw_8nsituhR33BpjU2w" target="_blank">整合ELK实现日志收集</a></li>
</ul>
<h2 id="五-监控组件">五. 监控组件</h2>
<h3 id="1-全局监控">1. 全局监控</h3>
<p>不知道你还记不记得，我们这个系统的架构：</p>
<p><img alt="" src="assets/6813d1db67e644c389f266b8449239b3.jpg"/></p>
<p>根据这个系统的架构，我们选择的工具要监控到这几个层面：</p>
<ul>
<li>第一层，物理主机；</li>
<li>第二层，KVM 虚拟机；</li>
<li>第三层，Kubernetes套件；</li>
<li>第四层，各种应用所需要的技术组件。</li>
</ul>
<p>其实，有了上面的系统架构，监控设计就已经出现在写方案之人的脑袋里了。对于我们这个课程所用的系统，全局监控如下所示：</p>
<p><img alt="" src="assets/017e3615455f4c7598c1ccfccbd23593.jpg"/></p>
<p>从上图来看，我们使用 Prometheus/Grafana/Spring Boot Admin/SkyWalking/Weave Scope/ELK/EFK 就可以实现具有全局视角的第一层监控。对于工具中没有覆盖的第一层计数器，我们只能在执行场景时再执行命令来补充了。</p>
<h3 id="2-部署清单">2. 部署清单</h3>
<p><img alt="" src="assets/b5d4d92cebc440dcae9b7633850d2ea9.jpg"/></p>
<h3 id="3-安装部署">3. 安装部署</h3>
<p>对于上面这些监控工具的部署，我也把相应的安装教程放在这里，供你参考学习。</p>
<p>Kubernetes集群资源监控的部署：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/AOl_z0zMuPzRlf36J6OLMg" target="_blank">Kubernetes 集群监控 kube-prometheus 部署</a></li>
<li><a href="https://mp.weixin.qq.com/s/T1Yhbw2efw-wjKu1PZyudg" target="_blank">Kubernetes 集群监控 controller-manager &amp; scheduler 组件</a></li>
<li><a href="https://mp.weixin.qq.com/s/chvukvjmCDvrYqYapRCEkA" target="_blank">Kubernetes 集群监控 ETCD 组件</a></li>
</ul>
<p>日志聚合部署的部署：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/7shBCfpKRBBQDsutSpClhQ" target="_blank">Kubernetes 集群日志监控 EFK 安装</a></li>
</ul>
<p>依赖组件的部署：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/yuAU-qWeTr4svaSI497sbQ" target="_blank">Kubernetes 集群监控 kube-prometheus 自动发现</a></li>
</ul>
<p>APM 链路跟踪的部署：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/bDfPFjTF5W2z8XUD-8EYQQ" target="_blank">Kubernetes + Spring Cloud 集成链路追踪 SkyWalking</a></li>
</ul>
<h2 id="六-微服务">六. 微服务</h2>
<h3 id="1-项目介绍">1. 项目介绍</h3>
<p>在搭建这个课程所用的系统时，我采用了微服务的架构，这也是当前主流的技术架构。</p>
<p>如果你有兴趣了解详细的项目介绍，可以参考这篇文章：<a href="https://mp.weixin.qq.com/s/a8nDBbkuvSjreaCxuM2PuQ" target="_blank">《高楼的性能工程实战课》微服务电商项目技术全解析</a>。这里面主要介绍了该项目的一些预备知识、系统结构、主要技术栈以及核心组件。此外，还有相关的运行效果截图。</p>
<h3 id="2-拉取源代码">2. 拉取源代码</h3>
<p>我们把 git clone 项目源代码下载到本地，来部署我们的被测系统：</p>
<pre><code>git clone https://github.com/xncssj/7d-mall-microservice.git
</code></pre>
<h3 id="3-修改-nacos-配置">3. 修改 Nacos 配置</h3>
<p>我们先将项目 config 目录下的配置包导入到 Nacos 中，然后根据自己的实际需要修改相关配置。</p>
<p>接着，我们将配置信息导入到 Nacos 中后，会显示这样的信息：</p>
<p><img alt="" src="assets/2663b0fc65f048ec92260650a19434e1.jpg"/></p>
<p>请你注意，我们修改的配置文件主要是每个单体服务下的 application-prod.yml 和 bootstrap-prod.yml。因为两个全局配置文件，都是服务容器内加载的配置文件。</p>
<h3 id="4-镜像打包及推送">4. 镜像打包及推送</h3>
<p>我们使用 Java 语言的 IDE （推荐 IDEA ）打开项目工程。</p>
<p>首先，修改项目根目录下的 pom.xml 文件：</p>
<pre><code>&lt;properties&gt;
    &lt;!--改为你自己的 Docker 服务远程访问地址--&gt;
    &lt;docker.host&gt;http://172.16.106.237:2375&lt;/docker.host&gt;
&lt;/properties&gt;
</code></pre>
<p>在 IDEA 的右边 Maven 标签页，我们可以找到 root 工程下的 package 按钮，选中并执行：</p>
<p><img alt="" src="assets/bc041c1c908c48d595f3be993695464a.jpg"/></p>
<p>然后，在编译的远程 Docker 主机上，我们修改所有服务的镜像标签名称。之后，再推送镜像到 Docker 仓库。</p>
<h3 id="5-导入数据库">5. 导入数据库</h3>
<p>这一步需要将项目 document/sql 目录下的 SQL 脚本导入到 MySQL 数据库中。</p>
<h3 id="6-初始化依赖组件">6. 初始化依赖组件</h3>
<h4 id="6-1-rabbitmq">6.1. RabbitMQ</h4>
<p>第一步，进入 RabbitMQ 容器并开启管理功能：</p>
<pre><code>#登录容器的时候需要注意到容器支持的 shell 是什么。
kubectl exec -it &lt;pod-name&gt; -n &lt;ns-name&gt; bash
kubectl exec -it &lt;pod-name&gt; -n &lt;ns-name&gt; sh


root@cloud-rabbitmq-5b49d784c-gbr8m:/# rabbitmq-plugins enable rabbitmq_management
Enabling plugins on node rabbit@cloud-rabbitmq-5b49d784c-gbr8m:
rabbitmq_management
The following plugins have been configured:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch
Applying plugin configuration to rabbit@cloud-rabbitmq-5b49d784c-gbr8m...
Plugin configuration unchanged.
</code></pre>
<p>因为 RabbitMQ Service 使用 NodePort 的方式暴露控制台地址，比如 NodePort 为 15672。所以，第二步，我们访问地址 <a href="http://xn--IP-rm4eu79a9miiio:15672/" target="_blank">http://计算节点IP:15672/</a> 地址，查看是否安装成功：</p>
<p><img alt="" src="assets/e173cb22969e4bc3ab9372d124b989b5.jpg"/></p>
<p>第三步，输入账号密码并登录guest/guest。</p>
<p>第四步，创建帐号并设置其角色为管理员 mall/mall。</p>
<p><img alt="" src="assets/4856ae6a85354bc2b519062b25a8cd53.jpg"/></p>
<p>第五步，创建一个新的虚拟 host 为 /mall。</p>
<p><img alt="" src="assets/9fc448b55f274df88124fa8f8adf0c40.jpg"/></p>
<p>第六步，点击 mall 用户进入用户配置页面，给 mall 用户配置该虚拟 host 的权限。</p>
<p><img alt="" src="assets/e5a9655341be49d1a0e9b3ad36c53dd1.jpg"/></p>
<p>到这里，RabbitMQ 的初始化就完成了。</p>
<h4 id="6-2-elasticsearch">6.2. Elasticsearch</h4>
<p>安装中文分词器 IKAnalyzer，并重新启动：</p>
<pre><code>#此命令需要在容器中运行
elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip
</code></pre>
<h3 id="7-使用-yaml-资源文件部署应用">7. 使用 yaml 资源文件部署应用</h3>
<p>将项目 document/k8s 目录下的 yaml 资源文件中的 Dokcer 镜像，修改为自己的 Tag 并上传到 k8s 集群中执行：</p>
<pre><code>kubectl apply -f k8s/
</code></pre>
<h2 id="七-运行效果展示">七. 运行效果展示</h2>
<h3 id="1-服务器">1. 服务器</h3>
<p><img alt="" src="assets/0105d4e36d084de9b5672064bb66fe3d.jpg"/></p>
<h3 id="2-虚拟机">2. 虚拟机</h3>
<p><img alt="" src="assets/24259e389328405896893b80d1f47201.jpg"/></p>
<h3 id="3-kubernetes-集群">3. Kubernetes 集群</h3>
<p>Kubernetes 集群：</p>
<pre><code>[root@k8s-master-1 ~]# kubectl get nodes
NAME           STATUS   ROLES    AGE   VERSION
k8s-master-1   Ready    master   26d   v1.19.2
k8s-master-2   Ready    master   26d   v1.19.2
k8s-master-3   Ready    master   26d   v1.19.2
k8s-worker-1   Ready    &lt;none&gt;   26d   v1.19.2
k8s-worker-2   Ready    &lt;none&gt;   26d   v1.19.2
k8s-worker-3   Ready    &lt;none&gt;   26d   v1.19.2
k8s-worker-4   Ready    &lt;none&gt;   26d   v1.19.2
k8s-worker-5   Ready    &lt;none&gt;   26d   v1.19.2
k8s-worker-6   Ready    &lt;none&gt;   26d   v1.19.2
k8s-worker-7   Ready    &lt;none&gt;   26d   v1.19.2
k8s-worker-8   Ready    &lt;none&gt;   26d   v1.19.2
k8s-worker-9   Ready    &lt;none&gt;   26d   v1.19.2
[root@k8s-master-1 ~]# 
</code></pre>
<p>微服务管理：</p>
<p><img alt="" src="assets/50019a50d09844738007221bdf7da287.jpg"/></p>
<h3 id="4-微服务">4. 微服务</h3>
<p>部署架构图：</p>
<p><img alt="" src="assets/64894adc6d314c12907aaa8e34fa288c.jpg"/></p>
<p>API 文档：</p>
<p><img alt="" src="assets/e78495037a224d38b9457713a9c08b71.jpg"/></p>
<p>调用链监控：-
<img alt="" src="assets/0d5c1a1d39f2489bae6d2ddb12f7e6c4.jpg"/>-
<img alt="" src="assets/8280b817178d466cb203f8e1083e869f.jpg"/></p>
<p><img alt="" src="assets/62a5a30292674cf88bc01369f6f5ace3.jpg"/></p>
<p>服务注册：</p>
<p><img alt="" src="assets/efa085195525434ca38f3a39acbfcf97.jpg"/></p>
<p>服务监控:-
<img alt="" src="assets/e992f02a8c344ea7ad8711e0213f4981.jpg"/></p>
<p>日志聚合：</p>
<p><img alt="" src="assets/32dfd4958ac1442eb8f75f2d722a7bdc.jpg"/></p>
<p>配置管理：</p>
<p><img alt="" src="assets/c3780c97b1a84f7199f5982335e01193.jpg"/></p>
<p>系统保护：</p>
<p><img alt="" src="assets/20c13ece33e24f729dd6cefcb115a300.jpg"/></p>
<p>容器仓库：</p>
<p><img alt="" src="assets/4280702aa6c447e7a1b92b598776e54b.jpg"/></p>
<p>压力引擎：</p>
<p><img alt="" src="assets/358b6a52aac844a682ffe23c429fc67c.jpg"/></p>
<h3 id="5-资源监控">5.资源监控</h3>
<p>Kubernetes集群资源监控：</p>
<p><img alt="" src="assets/19bc98d3839545d9961594532eaf2aba.jpg"/></p>
<p>Linux 资源监控：</p>
<p><img alt="" src="assets/c1b86cccbb4e4143af0eef21befdee5e.jpg"/></p>
<p>MySQL 资源监控：</p>
<p><img alt="" src="assets/70042b6420954484932c126b93b94e23.jpg"/></p>
<p>RabbitMQ 资源监控：</p>
<p><img alt="" src="assets/506905151126495d901deebca081b508.jpg"/></p>
<p>MongoDB 数据库资源监控：</p>
<p><img alt="" src="assets/6592a47a6c454b72b96b475fd79af2bb.jpg"/></p>
<p>Kubernetes etcd 资源监控：</p>
<p><img alt="" src="assets/6392c1e852654e9399dc7ab489f02064.jpg"/></p>
<p>Kubernetes API Server 资源监控：</p>
<p><img alt="" src="assets/89f1dcfe006647428fd658397f365bac.jpg"/></p>
<p>Kubernetes 服务拓扑：</p>
<p><img alt="" src="assets/844b6143e32b4f99be0b74e85f174f8e.jpg"/></p>
<h2 id="八-总结">八. 总结</h2>
<p>这节课的内容包括了物理环境的说明、技术组件的具体搭建过程、示例系统的搭建过程以及运行效果。经过上面所有的步骤，我们就把整个课程涉及的所有技术组件、示例系统完全搭建起来了。</p>
<p>而我之所以选择这样的技术栈，主要有三方面的考虑：</p>
<p><strong>1. 核心优势</strong></p>
<ul>
<li>任务调度：为集群系统中的任务提供调度服务，自动将服务按资源需求分配到资源限制的计算节点；</li>
<li>资源隔离：为产品提供管控与服务节点隔离能力，保证研发应用和管控服务不产生相互的影响；</li>
<li>高可用能力：自动监控服务运行，根据运行情况对失效的服务进行自动重启恢复；</li>
<li>网络互联互通能力：提供统一的IP地址分配和网络互通能力；</li>
<li>统一编排管理能力：结合 Gitlab 和 k8s ，对输出的产品进行统一的编排管理；</li>
<li>公共产品组件可以为团队提供统一部署、验证、授权、调度和管控能力，为私有云服务提供基础性的支撑。</li>
</ul>
<p><strong>2. 核心设施平台（IaaS云）</strong></p>
<ul>
<li>提供计算、网络、存储等核心资源设备的虚拟化；</li>
<li>支持不同操作系统，包括主流的 Win 和 Linux 系统；</li>
<li>提供主要的三种服务：云主机、云网络、云硬盘；</li>
<li>提供可视化 Web UI；</li>
<li>提供 k8s 集群（容器云）规划、部署和运营；</li>
<li>支持多种计算、存储和网络方案。</li>
</ul>
<p><strong>3. 基础服务平台（PaaS云）</strong></p>
<ul>
<li>提供数据存储：支持常见 NFS 、Ceph RBD、Local Volume 等；</li>
<li>提供应用服务：支持自愈和自动伸缩、调度和发布、负载均衡等；</li>
<li>提供运维管理：支持日志监控、资源监控、消息告警等。</li>
</ul>
<p>我们这个系统采用的技术栈，是当前技术市场中流行的主流技术栈，这样的环境具有很高的借鉴价值。而且，从我们要表达的 RESAR 性能分析架构和逻辑来说，也说明 RESAR 性能分析理念是足以支撑当前的技术栈的。</p>
<h2 id="参考资料汇总">参考资料汇总</h2>
<p><strong>1. CentOS 7的部署</strong>：<a href="https://blog.csdn.net/zuozewei/article/details/84951690" target="_blank">HP 服务器安装 CentOS 7</a>-
<strong>2. KVM的优化重点</strong>：<a href="https://mp.weixin.qq.com/s/L-jNlwYKFWgoKX6L5ffz5A" target="_blank">关于KVM 虚拟化注意的二三事整理</a>-
<strong>3. KVM 的安装和使用</strong>：<a href="https://mp.weixin.qq.com/s/UluDn0jG-uYZqpIsIXzKAg" target="_blank">Linux KVM 安装使用手册</a>-
<strong>4. Kubernetes 集群搭建</strong>：</p>
<ul>
<li>单 Master 集群：<a href="https://mp.weixin.qq.com/s/eQOMt3dz1P2JwezDaoZGzg" target="_blank">使用 kubeadm 安装单master kubernetes 集群（脚本版）</a></li>
<li>高可用方案： <a href="https://mp.weixin.qq.com/s/bdq4GySQWjcIjJmn0ZD80g" target="_blank">Kubernetes 高可用集群落地二三事</a></li>
</ul>
<p><strong>5. Kubernetes的使用基础</strong>：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/X2Z_a_eYq12O6yTQmRRxfw" target="_blank">Kubernetes 集群基本概念</a></li>
<li><a href="https://mp.weixin.qq.com/s/dSbCK_ms4YMoEvqp0afNZg" target="_blank">k8s入门篇-Kubernetes的基本概念和术语</a></li>
<li><a href="https://mp.weixin.qq.com/s/EPdOEwFaoc-hI27C0v3urA" target="_blank">K8s命令篇-Kubernetes工作实用命令集结号</a></li>
<li><a href="https://mp.weixin.qq.com/s/xYjR5_WZNhny_0RdjM1tpA" target="_blank">Kubernetes 集群常用操作总结</a></li>
</ul>
<p><strong>6. Kubernetes网络插件选型</strong>：<a href="https://mp.weixin.qq.com/s/H4ncgG0AqsmpPSg3ICBP3g" target="_blank">Kubernetes 网络插件（CNI）超过 10Gbit/s 的基准测试结果</a></p>
<p><strong>7. NFS部署</strong>： <a href="https://mp.weixin.qq.com/s/xKPAHWuLBMYuaVzpel5rUQ" target="_blank">Kubernetes 集群部署 NFS 网络存储</a></p>
<p><strong>8. Ceph部署</strong>： <a href="https://mp.weixin.qq.com/s/tww0dPNeFNR_WaEWUh97ZQ" target="_blank">Kubernetes 集群分布式存储插件 Rook Ceph部署</a></p>
<p><strong>9. Kubernetes下的MySQL部署</strong>：<a href="https://mp.weixin.qq.com/s/4YSx4a2oqjrp1f6wNQgR-g" target="_blank">如何在 Kubernetes 集群中搭建一个复杂的 MySQL 数据库</a></p>
<p><strong>10. Elasticsearch 集群的部署</strong>：<a href="https://mp.weixin.qq.com/s/VAlbWoSf_16-Cf5nIwEShg" target="_blank">Kubernetes Helm3 部署 Elasticsearch &amp; Kibana 7 集群</a></p>
<p><strong>11. JMeter的部署</strong>：</p>
<ul>
<li>二进制：<a href="https://mp.weixin.qq.com/s/nUNAz3Gma9fwoFNFA9Orog" target="_blank">性能工具之JMeter+InfluxDB+Grafana打造压测可视化实时监控</a></li>
<li>Kubernetes：<a href="https://mp.weixin.qq.com/s/VQl05FvzK456WAkXDM6I9Q" target="_blank">Kubernetes 下部署 Jmeter 集群</a></li>
</ul>
<p><strong>12. 镜像仓库 Harbor 的部署</strong>：<a href="https://mp.weixin.qq.com/s/_0hEWz7TUvYGASg9I3az4g" target="_blank">Kubernetes 集群仓库 harbor Helm3 部署</a></p>
<p><strong>13. Nacos 的部署</strong>：</p>
<ul>
<li>Docker 单机模式： <a href="https://nacos.io/zh-cn/docs/quick-start-docker.html" target="_blank">Nacos Docker 快速开始</a></li>
<li>Kubernetes：<a href="https://nacos.io/zh-cn/docs/use-nacos-with-kubernetes.html" target="_blank">Kubernetes Nacos</a></li>
</ul>
<p><strong>14. Redis、RabbitMQ、MongoDB 单机部署的部署</strong>：<a href="https://mp.weixin.qq.com/s/yuAU-qWeTr4svaSI497sbQ" target="_blank">Kubernetes 集群监控 kube-prometheus 自动发现</a></p>
<p><strong>15. Logstash 的部署</strong>：<a href="https://mp.weixin.qq.com/s/D7Xuw_8nsituhR33BpjU2w" target="_blank">整合ELK实现日志收集</a></p>
<p><strong>16. Kubernetes集群资源监控的部署</strong>：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/AOl_z0zMuPzRlf36J6OLMg" target="_blank">Kubernetes 集群监控 kube-prometheus 部署</a></li>
<li><a href="https://mp.weixin.qq.com/s/T1Yhbw2efw-wjKu1PZyudg" target="_blank">Kubernetes 集群监控 controller-manager &amp; scheduler 组件</a></li>
<li><a href="https://mp.weixin.qq.com/s/chvukvjmCDvrYqYapRCEkA" target="_blank">Kubernetes 集群监控 ETCD 组件</a></li>
</ul>
<p><strong>17. 日志聚合部署的部署</strong>：<a href="https://mp.weixin.qq.com/s/7shBCfpKRBBQDsutSpClhQ" target="_blank">Kubernetes 集群日志监控 EFK 安装</a></p>
<p><strong>18. 依赖组件的部署</strong>：<a href="https://mp.weixin.qq.com/s/yuAU-qWeTr4svaSI497sbQ" target="_blank">Kubernetes 集群监控 kube-prometheus 自动发现</a></p>
<p><strong>19. APM 链路跟踪的部署</strong>：<a href="https://mp.weixin.qq.com/s/bDfPFjTF5W2z8XUD-8EYQQ" target="_blank">Kubernetes + Spring Cloud 集成链路追踪 SkyWalking</a></p>
<p><strong>20. 微服务项目介绍</strong>：<a href="https://mp.weixin.qq.com/s/a8nDBbkuvSjreaCxuM2PuQ" target="_blank">《高楼的性能工程实战课》微服务电商项目技术全解析</a></p>
<p><strong>21. 其他学习资料推荐</strong>：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/JeKdirFrM5LGAqZrrdKoXA" target="_blank">SpringCloud 日志在压测中的二三事</a></li>
<li><a href="https://mp.weixin.qq.com/s/KHGfK7DUbSBcNOF6J8mb6Q" target="_blank">高楼的性能工程实战课之脚本开发</a></li>
<li><a href="https://mp.weixin.qq.com/s/tYooETSGhiMBBDlwihiqAA" target="_blank">《高楼的性能工程实战课》学习所推荐的知识点</a></li>
</ul>
</div>
</div>
<div>
<div id="prePage" style="float: left">
</div>
<div id="nextPage" style="float: right">
</div>
</div>
</div>
</div>
</div>
<div class="copyright">
<hr/>
<p>© 2019 - 2023 <a href="/cdn-cgi/l/email-protection#325e5e5e0b060303020572555f535b5e1c515d5f" target="_blank">Liangliang Lee</a>.
                    Powered by <a href="https://github.com/gin-gonic/gin" target="_blank">gin</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p>
</div>
</div>
<a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93598dc949bd064a',t:'MTc0NTUzOTE2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script src="/static/index.js"></script>
</head></html>