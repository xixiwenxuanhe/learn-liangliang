<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="zh-cn" http-equiv="content-language"/>
<meta content="15 深度和宽度兼具的融合模型 Wide and Deep" name="description"/>
<link href="/static/favicon.png" rel="icon"/>
<title>15 深度和宽度兼具的融合模型 Wide and Deep </title>
<link href="/static/index.css" rel="stylesheet"/>
<link href="/static/highlight.min.css" rel="stylesheet"/>
<script src="/static/highlight.min.js"></script>
<meta content="Hexo 4.2.0" name="generator"/>
<script data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" defer="" src="https://umami.lianglianglee.com/script.js"></script>
</head>
<body>
<div class="book-container">
<div class="book-sidebar">
<div class="book-brand">
<a href="/">
<img src="/static/favicon.png"/>
<span>技术文章摘抄</span>
</a>
</div>
<div class="book-menu uncollapsible">
<ul class="uncollapsible">
<li><a class="current-tab" href="/">首页</a></li>
<li><a href="../">上一级</a></li>
</ul>
<ul class="uncollapsible">
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/00%20%e5%bc%80%e7%af%87%e8%af%8d%20%e7%94%a8%e7%9f%a5%e8%af%86%e5%8e%bb%e5%af%b9%e6%8a%97%e6%8a%80%e6%9c%af%e4%b8%8d%e5%b9%b3%e7%ad%89.md.html" id="00 开篇词 用知识去对抗技术不平等.md.html">00 开篇词 用知识去对抗技术不平等.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/01%20%e4%bd%a0%e7%9c%9f%e7%9a%84%e9%9c%80%e8%a6%81%e4%b8%aa%e6%80%a7%e5%8c%96%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e5%90%97_.md.html" id="01 你真的需要个性化推荐系统吗_.md.html">01 你真的需要个性化推荐系统吗_.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/02%20%e4%b8%aa%e6%80%a7%e5%8c%96%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e6%9c%89%e5%93%aa%e4%ba%9b%e7%bb%95%e4%b8%8d%e5%bc%80%e7%9a%84%e7%bb%8f%e5%85%b8%e9%97%ae%e9%a2%98%ef%bc%9f.md.html" id="02 个性化推荐系统有哪些绕不开的经典问题？.md.html">02 个性化推荐系统有哪些绕不开的经典问题？.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/03%20%e8%bf%99%e4%ba%9b%e4%bd%a0%e5%bf%85%e9%a1%bb%e5%ba%94%e8%af%a5%e5%85%b7%e5%a4%87%e7%9a%84%e6%80%9d%e7%bb%b4%e6%a8%a1%e5%bc%8f.md.html" id="03 这些你必须应该具备的思维模式.md.html">03 这些你必须应该具备的思维模式.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/04%20%e7%94%bb%e9%ac%bc%e5%ae%b9%e6%98%93%e7%94%bb%e4%ba%ba%e9%9a%be%ef%bc%9a%e7%94%a8%e6%88%b7%e7%94%bb%e5%83%8f%e7%9a%84%e2%80%9c%e8%83%bd%e2%80%9d%e5%92%8c%e2%80%9c%e4%b8%8d%e8%83%bd%e2%80%9d.md.html" id="04 画鬼容易画人难：用户画像的“能”和“不能”.md.html">04 画鬼容易画人难：用户画像的“能”和“不能”.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/05%20%e4%bb%8e%e6%96%87%e6%9c%ac%e5%88%b0%e7%94%a8%e6%88%b7%e7%94%bb%e5%83%8f%e6%9c%89%e5%a4%9a%e8%bf%9c.md.html" id="05 从文本到用户画像有多远.md.html">05 从文本到用户画像有多远.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/06%20%e8%b6%85%e8%b6%8a%e6%a0%87%e7%ad%be%e7%9a%84%e5%86%85%e5%ae%b9%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f.md.html" id="06 超越标签的内容推荐系统.md.html">06 超越标签的内容推荐系统.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/07%20%e4%ba%ba%e4%bb%a5%e7%be%a4%e5%88%86%ef%bc%8c%e4%bd%a0%e6%98%af%e4%bb%80%e4%b9%88%e4%ba%ba%e5%b0%b1%e7%9c%8b%e5%88%b0%e4%bb%80%e4%b9%88%e4%b8%96%e7%95%8c.md.html" id="07 人以群分，你是什么人就看到什么世界.md.html">07 人以群分，你是什么人就看到什么世界.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/08%20%e8%a7%a3%e5%af%86%e2%80%9c%e7%9c%8b%e4%ba%86%e5%8f%88%e7%9c%8b%e2%80%9d%e5%92%8c%e2%80%9c%e4%b9%b0%e4%ba%86%e5%8f%88%e4%b9%b0%e2%80%9d.md.html" id="08 解密“看了又看”和“买了又买”.md.html">08 解密“看了又看”和“买了又买”.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/09%20%e5%8d%8f%e5%90%8c%e8%bf%87%e6%bb%a4%e4%b8%ad%e7%9a%84%e7%9b%b8%e4%bc%bc%e5%ba%a6%e8%ae%a1%e7%ae%97%e6%96%b9%e6%b3%95%e6%9c%89%e5%93%aa%e4%ba%9b.md.html" id="09 协同过滤中的相似度计算方法有哪些.md.html">09 协同过滤中的相似度计算方法有哪些.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/10%20%e9%82%a3%e4%ba%9b%e5%9c%a8Netflix%20Prize%e4%b8%ad%e5%a4%a7%e6%94%be%e5%bc%82%e5%bd%a9%e7%9a%84%e6%8e%a8%e8%8d%90%e7%ae%97%e6%b3%95.md.html" id="10 那些在Netflix Prize中大放异彩的推荐算法.md.html">10 那些在Netflix Prize中大放异彩的推荐算法.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/11%20Facebook%e6%98%af%e6%80%8e%e4%b9%88%e4%b8%ba%e5%8d%81%e4%ba%bf%e4%ba%ba%e4%ba%92%e7%9b%b8%e6%8e%a8%e8%8d%90%e5%a5%bd%e5%8f%8b%e7%9a%84.md.html" id="11 Facebook是怎么为十亿人互相推荐好友的.md.html">11 Facebook是怎么为十亿人互相推荐好友的.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/12%20%e5%a6%82%e6%9e%9c%e5%85%b3%e6%b3%a8%e6%8e%92%e5%ba%8f%e6%95%88%e6%9e%9c%ef%bc%8c%e9%82%a3%e4%b9%88%e8%bf%99%e4%b8%aa%e6%a8%a1%e5%9e%8b%e5%8f%af%e4%bb%a5%e5%b8%ae%e5%88%b0%e4%bd%a0.md.html" id="12 如果关注排序效果，那么这个模型可以帮到你.md.html">12 如果关注排序效果，那么这个模型可以帮到你.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/13%20%e7%bb%8f%e5%85%b8%e6%a8%a1%e5%9e%8b%e8%9e%8d%e5%90%88%e5%8a%9e%e6%b3%95%ef%bc%9a%e7%ba%bf%e6%80%a7%e6%a8%a1%e5%9e%8b%e5%92%8c%e6%a0%91%e6%a8%a1%e5%9e%8b%e7%9a%84%e7%bb%84%e5%90%88%e6%8b%b3.md.html" id="13 经典模型融合办法：线性模型和树模型的组合拳.md.html">13 经典模型融合办法：线性模型和树模型的组合拳.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/14%20%e4%b8%80%e7%bd%91%e6%89%93%e5%b0%bd%e5%8d%8f%e5%90%8c%e8%bf%87%e6%bb%a4%e3%80%81%e7%9f%a9%e9%98%b5%e5%88%86%e8%a7%a3%e5%92%8c%e7%ba%bf%e6%80%a7%e6%a8%a1%e5%9e%8b.md.html" id="14 一网打尽协同过滤、矩阵分解和线性模型.md.html">14 一网打尽协同过滤、矩阵分解和线性模型.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/15%20%e6%b7%b1%e5%ba%a6%e5%92%8c%e5%ae%bd%e5%ba%a6%e5%85%bc%e5%85%b7%e7%9a%84%e8%9e%8d%e5%90%88%e6%a8%a1%e5%9e%8b%20Wide%20and%20Deep.md.html" id="15 深度和宽度兼具的融合模型 Wide and Deep.md.html">15 深度和宽度兼具的融合模型 Wide and Deep.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/16%20%e7%ae%80%e5%8d%95%e5%8d%b4%e6%9c%89%e6%95%88%e7%9a%84Bandit%e7%ae%97%e6%b3%95.md.html" id="16 简单却有效的Bandit算法.md.html">16 简单却有效的Bandit算法.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/17%20%e7%bb%93%e5%90%88%e4%b8%8a%e4%b8%8b%e6%96%87%e4%bf%a1%e6%81%af%e7%9a%84Bandit%e7%ae%97%e6%b3%95.md.html" id="17 结合上下文信息的Bandit算法.md.html">17 结合上下文信息的Bandit算法.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/18%20%e5%a6%82%e4%bd%95%e5%b0%86Bandit%e7%ae%97%e6%b3%95%e4%b8%8e%e5%8d%8f%e5%90%8c%e8%bf%87%e6%bb%a4%e7%bb%93%e5%90%88%e4%bd%bf%e7%94%a8.md.html" id="18 如何将Bandit算法与协同过滤结合使用.md.html">18 如何将Bandit算法与协同过滤结合使用.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/19%20%e6%b7%b1%e5%ba%a6%e5%ad%a6%e4%b9%a0%e5%9c%a8%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%ad%e7%9a%84%e5%ba%94%e7%94%a8%e6%9c%89%e5%93%aa%e4%ba%9b_.md.html" id="19 深度学习在推荐系统中的应用有哪些_.md.html">19 深度学习在推荐系统中的应用有哪些_.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/20%20%e7%94%a8RNN%e6%9e%84%e5%bb%ba%e4%b8%aa%e6%80%a7%e5%8c%96%e9%9f%b3%e4%b9%90%e6%92%ad%e5%8d%95.md.html" id="20 用RNN构建个性化音乐播单.md.html">20 用RNN构建个性化音乐播单.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/21%20%e6%9e%84%e5%bb%ba%e4%b8%80%e4%b8%aa%e7%a7%91%e5%ad%a6%e7%9a%84%e6%8e%92%e8%a1%8c%e6%a6%9c%e4%bd%93%e7%b3%bb.md.html" id="21 构建一个科学的排行榜体系.md.html">21 构建一个科学的排行榜体系.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/22%20%e5%ae%9e%e7%94%a8%e7%9a%84%e5%8a%a0%e6%9d%83%e9%87%87%e6%a0%b7%e7%ae%97%e6%b3%95.md.html" id="22 实用的加权采样算法.md.html">22 实用的加权采样算法.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/23%20%e6%8e%a8%e8%8d%90%e5%80%99%e9%80%89%e6%b1%a0%e7%9a%84%e5%8e%bb%e9%87%8d%e7%ad%96%e7%95%a5.md.html" id="23 推荐候选池的去重策略.md.html">23 推荐候选池的去重策略.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/24%20%e5%85%b8%e5%9e%8b%e7%9a%84%e4%bf%a1%e6%81%af%e6%b5%81%e6%9e%b6%e6%9e%84%e6%98%af%e4%bb%80%e4%b9%88%e6%a0%b7%e7%9a%84.md.html" id="24 典型的信息流架构是什么样的.md.html">24 典型的信息流架构是什么样的.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/25%20Netflix%e4%b8%aa%e6%80%a7%e5%8c%96%e6%8e%a8%e8%8d%90%e6%9e%b6%e6%9e%84.md.html" id="25 Netflix个性化推荐架构.md.html">25 Netflix个性化推荐架构.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/26%20%e6%80%bb%e8%a7%88%e6%8e%a8%e8%8d%90%e6%9e%b6%e6%9e%84%e5%92%8c%e6%90%9c%e7%b4%a2%e3%80%81%e5%b9%bf%e5%91%8a%e7%9a%84%e5%85%b3%e7%b3%bb.md.html" id="26 总览推荐架构和搜索、广告的关系.md.html">26 总览推荐架构和搜索、广告的关系.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/27%20%e5%b7%a7%e5%a6%87%e9%9a%be%e4%b8%ba%e6%97%a0%e7%b1%b3%e4%b9%8b%e7%82%8a%ef%bc%9a%e6%95%b0%e6%8d%ae%e9%87%87%e9%9b%86%e5%85%b3%e9%94%ae%e8%a6%81%e7%b4%a0.md.html" id="27 巧妇难为无米之炊：数据采集关键要素.md.html">27 巧妇难为无米之炊：数据采集关键要素.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/28%20%e8%ae%a9%e4%bd%a0%e7%9a%84%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e5%8f%8d%e5%ba%94%e6%9b%b4%e5%bf%ab%ef%bc%9a%e5%ae%9e%e6%97%b6%e6%8e%a8%e8%8d%90.md.html" id="28 让你的推荐系统反应更快：实时推荐.md.html">28 让你的推荐系统反应更快：实时推荐.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/29%20%e8%ae%a9%e6%95%b0%e6%8d%ae%e9%a9%b1%e5%8a%a8%e8%90%bd%e5%9c%b0%ef%bc%8c%e4%bd%a0%e9%9c%80%e8%a6%81%e4%b8%80%e4%b8%aa%e5%ae%9e%e9%aa%8c%e5%b9%b3%e5%8f%b0.md.html" id="29 让数据驱动落地，你需要一个实验平台.md.html">29 让数据驱动落地，你需要一个实验平台.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/30%20%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e6%9c%8d%e5%8a%a1%e5%8c%96%e3%80%81%e5%ad%98%e5%82%a8%e9%80%89%e5%9e%8b%e5%8f%8aAPI%e8%ae%be%e8%ae%a1.md.html" id="30 推荐系统服务化、存储选型及API设计.md.html">30 推荐系统服务化、存储选型及API设计.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/31%20%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e7%9a%84%e6%b5%8b%e8%af%95%e6%96%b9%e6%b3%95%e5%8f%8a%e5%b8%b8%e7%94%a8%e6%8c%87%e6%a0%87%e4%bb%8b%e7%bb%8d.md.html" id="31 推荐系统的测试方法及常用指标介绍.md.html">31 推荐系统的测试方法及常用指标介绍.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/32%20%e9%81%93%e9%ab%98%e4%b8%80%e5%b0%ba%e9%ad%94%e9%ab%98%e4%b8%80%e4%b8%88%ef%bc%9a%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e7%9a%84%e6%94%bb%e9%98%b2.md.html" id="32 道高一尺魔高一丈：推荐系统的攻防.md.html">32 道高一尺魔高一丈：推荐系统的攻防.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/33%20%e5%92%8c%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e6%9c%89%e5%85%b3%e7%9a%84%e5%bc%80%e6%ba%90%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%a1%86%e6%9e%b6%e4%bb%8b%e7%bb%8d.md.html" id="33 和推荐系统有关的开源工具及框架介绍.md.html">33 和推荐系统有关的开源工具及框架介绍.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/34%20%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e5%9c%a8%e4%ba%92%e8%81%94%e7%bd%91%e4%ba%a7%e5%93%81%e5%95%86%e4%b8%9a%e9%93%be%e6%9d%a1%e4%b8%ad%e7%9a%84%e5%9c%b0%e4%bd%8d.md.html" id="34 推荐系统在互联网产品商业链条中的地位.md.html">34 推荐系统在互联网产品商业链条中的地位.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/35%20%e8%af%b4%e8%af%b4%e4%bf%a1%e6%81%af%e6%b5%81%e7%9a%84%e5%89%8d%e4%b8%96%e4%bb%8a%e7%94%9f.md.html" id="35 说说信息流的前世今生.md.html">35 说说信息流的前世今生.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/36%20%e7%bb%84%e5%bb%ba%e6%8e%a8%e8%8d%90%e5%9b%a2%e9%98%9f%e5%8f%8a%e5%b7%a5%e7%a8%8b%e5%b8%88%e7%9a%84%e5%ad%a6%e4%b9%a0%e8%b7%af%e5%be%84.md.html" id="36 组建推荐团队及工程师的学习路径.md.html">36 组建推荐团队及工程师的学习路径.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/%e5%8a%a0%e9%a4%90%20%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%8f%82%e8%80%83%e9%98%85%e8%af%bb.md.html" id="加餐 推荐系统的参考阅读.md.html">加餐 推荐系统的参考阅读.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e4%b8%89%e5%8d%81%e5%85%ad%e5%bc%8f/%e7%bb%93%e6%9d%9f%e8%af%ad%20%e9%81%87%e2%80%9c%e8%8d%90%e2%80%9d%e4%b9%8b%e5%90%8e%ef%bc%8c%e6%b1%9f%e6%b9%96%e5%86%8d%e8%a7%81.md.html" id="结束语 遇“荐”之后，江湖再见.md.html">结束语 遇“荐”之后，江湖再见.md.html</a>
</li>
<li><a href="/assets/捐赠.md.html">捐赠</a></li>
</ul>
</div>
</div>
<div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseleave="remove_inner()" onmouseover="add_inner()">
<div class="sidebar-toggle-inner"></div>
</div>
<div class="off-canvas-content">
<div class="columns">
<div class="column col-12 col-lg-12">
<div class="book-navbar">
<header class="navbar">
<section class="navbar-section">
<a onclick="open_sidebar()">
<i class="icon icon-menu"></i>
</a>
</section>
</header>
</div>
<div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
<div class="book-post">
<div align="center">因收到Google相关通知，网站将会择期关闭。<a href="https://lumendatabase.org/notices/44265620" target="_blank">相关通知内容</a><hr/></div>
<p align="center" id="tip"></p>
<h1 class="title" data-id="15 深度和宽度兼具的融合模型 Wide and Deep" id="title">15 深度和宽度兼具的融合模型 Wide and Deep</h1>
<div><p>我在前面已经提到过一个事实，就是推荐系统的框架大都是多种召回策略外挂一个融合排序。召回策略的姿势繁多，前面的专栏文章已经涉及了一部分内容。今天我们继续说融合排序。</p>
<h2 id="要深还是要宽">要深还是要宽</h2>
<p>融合排序，最常见的就是CTR预估，你一定不要把自己真的只局限在C上，这里说的CTR预估的C，可以是产品中的任何行为，视频是不是会看完，看完后是不是会收藏，是不是会分享到第三方平台，查看的商品是不是会购买等等，都可以看成那个可以被预估发生概率的CTR。</p>
<p>CTR预估的常见做法就是广义线性模型，如 Logistic Regression，然后再采用特征海洋战术，就是把几乎所有的精力都放在搞特征上：挖掘新特征、挖掘特征组合、寻找新的特征离散方法等等。</p>
<p>这种简单模型加特征工程的做法好处多多：</p>
<ol>
<li>线性模型简单，其训练和预测计算复杂度都相对低；</li>
<li>工程师的精力可以集中在发掘新的有效特征上，俗称特征工程；</li>
<li>工程师们可以并行化工作，各自挖掘特征；</li>
<li>线性模型的可解释性相对非线性模型要好。</li>
</ol>
<p>特征海洋战术让线性模型表现为一个很宽广（Wide）的模型，可以想象逻辑回归中那个特征向量在特征工程的加持下，越来越宽的样子。</p>
<p>最近十年，是深度学习独步天下的十年，犹如异军突起，一路摧城拔寨，战火自然也烧到了推荐系统领域，用深度神经网络来革“线性模型+特征工程”的命，也再自然不过。</p>
<p>用这种“深模型”升级以前的“宽模型”，尤其是深度学习“端到端”的诱惑，可以让每天沉迷搞特征无法自拔的工程师们主动投怀送抱。</p>
<p>深度学习在推荐领域的应用，其最大好处就是“洞悉本质般的精深”，优秀的泛化性能，可以给推荐很多惊喜。</p>
<p>硬币总有正反面，深度模型的泛化强于线性模型，也会导致推荐有时候看上去像是“找不着北”，就是大家常常自问的那句话：“不知道这是怎么推出来的？”用行话说，就是可解释性不好。</p>
<p>以前全面搞特征时，你叫人家“宽模型”小甜甜，现在新模型换旧模型，“深模型”一出，就叫“宽模型”牛夫人，这样不好，还是要两者合作，才能最大限度地发挥效果。</p>
<p>因此，Google在2016年就发表了他们在Google Play应用商店上实践检验过的CTR预估方法：Wide &amp; Deep模型，让两者一起为用户们服务，这样就取得了良好效果。</p>
<p>下面，我就为你详细介绍一下这个深宽模型。</p>
<h2 id="wide-deep模型">Wide &amp; Deep模型</h2>
<p>一个典型的推荐系统架构，其实很类似一个搜索引擎，搜索由检索和排序构成。推荐系统也有召回和排序两部构成，不过，推荐系统的检索过程并不一定有显式的检索语句，通常是拿着用户特征和场景特征去检索召回，其中用户特征也就是在前面的专栏中提到的用户画像。</p>
<p>示意图如下.</p>
<p><img alt="" src="assets/7e3c2abe330e98829c01a73b0f7125e1.png"/></p>
<p>简单描述一下这个示意图。</p>
<p>首先使用用户特征和上下文场景特征从物品库中召回候选推荐结果，比如得到100个物品，然后用融合模型对这100个物品做最终排序，输出给用户展示。</p>
<p>同时开始记录展示日志和用户行为日志，再把收集到的日志和用户特征、上下文场景特征、物品特征拉平成为模型的训练数据，训练新的模型，再用于后面的推荐，如此周而复始。</p>
<p>今天要说的深宽模型就是专门用于融合排序的，分成两部分来看。一部分是线性模型，一部分是深度非线性模型。整个示意图如下：-
<img alt="" src="assets/5ca21e4b2511cd4567fb630db5b14520.png"/></p>
<p>我来解释一下这个示意图，这个示意图有三部分。最左边是宽模型，中间是深宽模型，最右边是纯的深度模型。</p>
<p>首先，线性模型部分，也就是“宽模型”，形式如下：</p>
<p><img alt="" src="assets/ea301585c357cbfc77aba992048a103f.png"/></p>
<p>再次强调一下，这是线性模型的标准形式，逻辑回归只是在这基础上用sigmoid函数变换了一下。</p>
<p>模型中的X是特征，W是权重，b是模型的偏置，也是线性模型的截距。线性模型中常用的特征构造手段就是特征交叉。</p>
<p>例如：“性别=女 and 语言=英语。”就是由两个特征组合交叉而成，只有当“性别=女”取值为1，并且“语言=英语”也取值为1时，这个交叉特征才会取值为1。线性模型的输出这里采用的Logistic Regression。</p>
<p>好，现在把头转到右边，看看深度模型。深度模型其实就是一个前馈神经网络。</p>
<p>深度模型对原始的高维稀疏类别型特征，先进行嵌入学习，转换为稠密、低维的实值型向量，转换后的向量维度通常在10-100这个范围。</p>
<p>这里的嵌入学习，就是先随机初始化嵌入向量，再直接扔到整个前馈网络中，用目标函数来优化学习。</p>
<p>由于本专栏并不会专门讲深度学习的原理，后面还会继续讲到深度学习和推荐系统的结合使用，所以有必要在这里简单普及一下深度学习的基本概念，不然我自顾自地开车，你可能会觉得辣眼睛。</p>
<p>就以这里的“深”模型，也就是示意图中最右边的图为例，一个深度神经网络由输入层，隐藏层，输出层构成。</p>
<p>那这个和逻辑回归的区别在哪呢？你可以认为逻辑回归是个残缺的神经网络，只有输入层和输出层，没有隐藏层。</p>
<p>逻辑回归的输入层就是特征向量，原来我们熟悉的特征权重，就是神经网络的参数，就存在于这个残缺的神经网络输入层和输出层的连线上，后面都可以这么理解，深度神经网络参数都在那些连线上。</p>
<p>这个残缺神经网络的输出层做了两件事，这时特征值在经过连线送到输出层时已经乘以了连线上的参数，第一件事就是把这些值加起来，第二件事就是用sigmoid函数变换一下。</p>
<p>把逻辑回归当成一个残缺的神经网络理解后，再回头看真正的神经网络，这里多了一个隐藏层，这个多出来的隐藏层干的事就是刚才提到的输出层的两板斧。</p>
<p>只不过一个隐藏层可以有多个神经元在干这两件事，隐藏层的这多个神经元就相当于输出层的输入层。</p>
<p>这个增加的隐藏层有什么意义呢？意义就是给模型提供了非线性转换。</p>
<p>所谓深度学习，就是深度神经网络，就是有不止一层的隐藏层存在。层数越多，非线性越强，模型越复杂。还有两点需要说明：</p>
<ol>
<li>隐藏层的激活函数不一定是sigmoid函数，甚至往往不用sigmoid函数；</li>
<li>输出层的函数也不一定是sigmoid函数，这个根据预测目标而定，回归任务就是i 直接输出求和部分，二分类是sigmoid函数，多分类则是softmax。</li>
</ol>
<p>好，插播深度学习概念结束，回到主题来。深模型中，每一个隐藏层激活方式表示如下。</p>
<p><img alt="" src="assets/14aa900ea6ec08c3bff830a74680a16f.png"/></p>
<p>其中l表示第l个隐藏层，f是激活函数，通常选用ReLU，也叫整流线性单元，为什么选用ReLU而不是sigmoid函数，原因主要是sigmoid函数在误差反向传播时梯度容易饱和。</p>
<p>如果你不明白这句话可以不用管，不影响你上车。这里我用示意图说明了一下常用激活函数的形状。</p>
<p><img alt="" src="assets/92c0ef095e33a13f9b8a1bee6d8369c8.png"/></p>
<ol>
<li>紫色是sigmoid函数，就是逻辑回归用的那个，输入值是任意范围，输出是0到1之间；</li>
<li>草绿色是反正切函数，和sigmoid函数样子很像，输入值是任意范围，输出是-1到1之间；</li>
<li>红色就是ReLU函数，当输入小于0时，输出为0，当输入大于0时，输出等于输入；</li>
<li>蓝色是softplus函数，是一条渐近线，输入趋向于负无穷时，输出趋于0，输入趋于正无穷时，输出趋向于等于输入。</li>
</ol>
<p>最后，看看两者的融合，即深宽模型。深模型和宽模型，由逻辑回归作为最终输出单元，深模型最后一个隐藏层作为特征接入逻辑回归，宽模型的原始特征与之一起接入逻辑回归，然后训练参数。</p>
<p>参数学习就是通常说的端到端，把深模型和宽模型以及最终融合的权重放在一个训练流程中，直接对目标函数负责，不存在分阶段训练。它与机器学习中的集成学习方法有所区别，集成学习的子模型是独立训练的，只在融合阶段才会学习权重，这里是整体。</p>
<p>把深宽模型的最后输出过程表示成公式就是：-
<img alt="" src="assets/5b9f863e1301539b000ecc345435a1e8.png"/></p>
<p>其中，Y是我们要预估的行为，二值变量，如购买，或点击，Google的应用场景为“是否安装APP”。σ是sigmoid函数，<span class="math inline">\(W_wide^T \)</span>宽模型的权重，Φ(X)是宽模型的组合特征，<span class="math inline">\(W_deep^T \)</span>应用在深模型输出上的权重，<span class="math inline">\(a^(l_f ) \)</span>是深模型的最后一层输出，b是线性模型的偏置。</p>
<h2 id="几点技巧">几点技巧</h2>
<p>这个深宽模型已经在TensorFlow中有开源实现，具体落地时整个数据流如下图所示。</p>
<p><img alt="" src="assets/3e409c03607276cd105adff9db8ddfae.png"/></p>
<p>整个流程分为三大块：数据生成，模型训练，模型应用。</p>
<h3 id="1数据生成">1数据生成</h3>
<p>数据生成有几个要点：</p>
<p>每一条曝光日志就生成一条样本，标签就是1/0，安装了App就是1，否则就是0。</p>
<p>将字符串形式的特征映射为ID，需要用一个阈值过滤掉那些出现样本较少的特征。</p>
<p>对连续值做归一化，归一化的方法是：对累积分布函数P(X&lt;=x)划分nq个分位，落入第i个分位的特征都归一化为下图所示。</p>
<p><img alt="" src="assets/5b347c032c2d8bfae560a6c466f50172.png"/></p>
<h3 id="2模型训练">2模型训练</h3>
<p><img alt="" src="assets/b67786ddda65b04fb99cd2bba4f3e3d1.png"/></p>
<p>整个模型的示意如图所示。其要点，在深度模型侧：</p>
<ol>
<li>每个类别特征embedding成一个32维向量；</li>
<li>将所有类别特征的embedding变量连成一个1200维度左右的大向量；</li>
<li>1200维度向量就送进三层以ReLU作为激活函数的隐藏层；</li>
<li>最终从Logistic Regreesion输出。</li>
</ol>
<p>宽模型侧就是传统的做法：特征交叉组合。</p>
<p>当新的样本集合到来时，先是用上一次的模型来初始化模型参数，然后在此基础上进行训练。</p>
<p>新模型上线前，会先跑一遍，看看会不会出事，算是一个冒烟测试。</p>
<h3 id="3-模型应用">3 模型应用</h3>
<p>模型验证后，就发布到模型服务器。模型服务，每次网络请求输入的是来自召回模块的App候选列表以及用户特征，再对输入的每个App进行评分。评分就是用我们的“深宽模型”计算，再按照计算的CTR从高到低排序。</p>
<p>为了让每次请求响应时间在10ms量级，每次并不是串行地对每个候选App计算，而是多线程并行，将候选App分成若干并行批量计算。</p>
<p>正因为有这些小的优化点，GooglePlay的App推荐服务，就是在峰值时每秒计算千万级的App。</p>
<h2 id="总结">总结</h2>
<p>将传统的“宽模型”和新的“深模型”结合，虽然更多的是一种工程上的创新，但是非常有实用性，模型也容易很理解。</p>
<p>简单画一下全文重点。</p>
<ol>
<li>深宽模型是一个结合了传统线性模型和深度模型的工程创新。</li>
<li>这个模型适合高维稀疏特征的推荐场景，稀疏特征的可解释性加上深度模型的泛化性能，双剑合璧。</li>
<li>这个模型已经开源在TensorFlow中，大大减小了落地成本，感兴趣可自行取用。</li>
<li>为了提高模型的训练效率，每一次并不从头开始训练，而是用上一次模型参数来初始化当前模型的参数。</li>
<li>将类别型特征先做嵌入学习，再将嵌入稠密向量送入深度模型中。</li>
<li>为了提高服务的响应效率，对每次请求要计算的多个候选App采用并行评分计算的方式，大大降低响应时间。</li>
</ol>
<p>嗯，这真的是一个既博学又精深的模型啊。</p>
<p>最后一点后话，这个模型在线上效果还是不错的，以GooglePlay的App推荐效果为例，用户安装表现良好，对照实验结果如图所示。</p>
<p><img alt="" src="assets/33598c5cbef846e0eb4692d09898ced8.png"/></p>
<p>可以看到，线上效果直接相对于对照组（纯线性模型+人工特征）有3.9%的提升，但是线下的AUC值提高并不明显，这其实也给你提了个问题，AUC值是不是最佳的线下评估方式？欢迎留言一起讨论。</p>
<h2 id="本周知识图">本周知识图</h2>
<p><img alt="" src="assets/e424954514e0796abc0ff779372c5d23.jpg"/></p>
</div>
</div>
<div>
<div id="prePage" style="float: left">
</div>
<div id="nextPage" style="float: right">
</div>
</div>
</div>
</div>
</div>
<div class="copyright">
<hr/>
<p>© 2019 - 2023 <a href="/cdn-cgi/l/email-protection#d6bababaefe2e7e7e6e196b1bbb7bfbaf8b5b9bb" target="_blank">Liangliang Lee</a>.
                    Powered by <a href="https://github.com/gin-gonic/gin" target="_blank">gin</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p>
</div>
</div>
<a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9358d621dcdb8284',t:'MTc0NTUzMTYzOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script src="/static/index.js"></script>
</head></html>