<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="zh-cn" http-equiv="content-language"/>
<meta content="22 深入解读过滤器模式：制作一杯鲜纯细腻的豆浆" name="description"/>
<link href="/static/favicon.png" rel="icon"/>
<title>22 深入解读过滤器模式：制作一杯鲜纯细腻的豆浆 </title>
<link href="/static/index.css" rel="stylesheet"/>
<link href="/static/highlight.min.css" rel="stylesheet"/>
<script src="/static/highlight.min.js"></script>
<meta content="Hexo 4.2.0" name="generator"/>
<script data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" defer="" src="https://umami.lianglianglee.com/script.js"></script>
</head>
<body>
<div class="book-container">
<div class="book-sidebar">
<div class="book-brand">
<a href="/">
<img src="/static/favicon.png"/>
<span>技术文章摘抄</span>
</a>
</div>
<div class="book-menu uncollapsible">
<ul class="uncollapsible">
<li><a class="current-tab" href="/">首页</a></li>
<li><a href="../">上一级</a></li>
</ul>
<ul class="uncollapsible">
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/00%20%e7%94%9f%e6%b4%bb%e4%b8%ad%e7%9a%84%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%ef%bc%9a%e5%90%af%e7%a8%8b%e4%b9%8b%e5%89%8d%ef%bc%8c%e8%af%b7%e4%b8%8d%e8%a6%81%e9%94%99%e8%bf%87%e6%88%91.md.html" id="00 生活中的设计模式：启程之前，请不要错过我.md.html">00 生活中的设计模式：启程之前，请不要错过我.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/01%20%e7%9b%91%e5%90%ac%e6%a8%a1%e5%bc%8f%ef%bc%9a%e5%9d%91%e7%88%b9%e7%9a%84%e7%83%ad%e6%b0%b4%e5%99%a8.md.html" id="01 监听模式：坑爹的热水器.md.html">01 监听模式：坑爹的热水器.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/02%20%e9%80%82%e9%85%8d%e6%a8%a1%e5%bc%8f%ef%bc%9a%e8%ba%ab%e9%ab%98%e4%b8%8d%e5%a4%9f%e9%9e%8b%e6%9d%a5%e5%87%91.md.html" id="02 适配模式：身高不够鞋来凑.md.html">02 适配模式：身高不够鞋来凑.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/03%20%e7%8a%b6%e6%80%81%e6%a8%a1%e5%bc%8f%ef%bc%9a%e4%ba%ba%e4%b8%8e%e6%b0%b4%e7%9a%84%e4%b8%89%e6%80%81.md.html" id="03 状态模式：人与水的三态.md.html">03 状态模式：人与水的三态.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/04%20%e5%8d%95%e4%be%8b%e6%a8%a1%e5%bc%8f%ef%bc%9a%e4%bd%a0%e6%98%af%e6%88%91%e7%94%9f%e5%91%bd%e7%9a%84%e5%94%af%e4%b8%80.md.html" id="04 单例模式：你是我生命的唯一.md.html">04 单例模式：你是我生命的唯一.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/05%20%e8%81%8c%e8%b4%a3%e6%a8%a1%e5%bc%8f%ef%bc%9a%e6%88%91%e7%9a%84%e5%81%87%e6%9d%a1%e5%8e%bb%e5%93%aa%e4%ba%86.md.html" id="05 职责模式：我的假条去哪了.md.html">05 职责模式：我的假条去哪了.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/06%20%e4%b8%ad%e4%bb%8b%e6%a8%a1%e5%bc%8f%ef%bc%9a%e6%89%be%e6%88%bf%e5%ad%90%e9%97%ae%e4%b8%ad%e4%bb%8b.md.html" id="06 中介模式：找房子问中介.md.html">06 中介模式：找房子问中介.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/07%20%e4%bb%a3%e7%90%86%e6%a8%a1%e5%bc%8f%ef%bc%9a%e5%b8%ae%e6%88%91%e6%8b%bf%e4%b8%80%e4%b8%8b%e5%bf%ab%e9%80%92.md.html" id="07 代理模式：帮我拿一下快递.md.html">07 代理模式：帮我拿一下快递.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/08%20%e8%a3%85%e9%a5%b0%e6%a8%a1%e5%bc%8f%ef%bc%9a%e4%bd%a0%e6%83%b3%e6%80%8e%e4%b9%88%e7%a9%bf%e5%b0%b1%e6%80%8e%e4%b9%88%e7%a9%bf.md.html" id="08 装饰模式：你想怎么穿就怎么穿.md.html">08 装饰模式：你想怎么穿就怎么穿.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/09%20%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f%ef%bc%9a%e4%bd%a0%e8%a6%81%e6%8b%bf%e9%93%81%e8%bf%98%e6%98%af%e6%91%a9%e5%8d%a1.md.html" id="09 工厂模式：你要拿铁还是摩卡.md.html">09 工厂模式：你要拿铁还是摩卡.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/10%20%e8%bf%ad%e4%bb%a3%e6%a8%a1%e5%bc%8f%ef%bc%9a%e4%b8%8b%e4%b8%80%e4%b8%aa%e5%b0%b1%e6%98%af%e4%bd%a0%e4%ba%86.md.html" id="10 迭代模式：下一个就是你了.md.html">10 迭代模式：下一个就是你了.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/11%20%e7%bb%84%e5%90%88%e6%a8%a1%e5%bc%8f%ef%bc%9a%e8%87%aa%e5%b7%b1%e7%bb%84%e8%a3%85%e7%94%b5%e8%84%91.md.html" id="11 组合模式：自己组装电脑.md.html">11 组合模式：自己组装电脑.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/12%20%e6%9e%84%e5%bb%ba%e6%a8%a1%e5%bc%8f%ef%bc%9a%e6%83%b3%e8%a6%81%e8%bd%a6%e8%bf%98%e6%98%af%e5%ba%84%e5%9b%ad.md.html" id="12 构建模式：想要车还是庄园.md.html">12 构建模式：想要车还是庄园.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/13%20%e5%85%8b%e9%9a%86%e6%a8%a1%e5%bc%8f%ef%bc%9a%e7%bb%99%e4%bd%a0%e4%b8%80%e4%b8%aa%e5%88%86%e8%ba%ab%e6%9c%af.md.html" id="13 克隆模式：给你一个分身术.md.html">13 克隆模式：给你一个分身术.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/14%20%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f%ef%bc%9a%e6%80%8e%e4%b9%88%e6%9d%a5%e4%b8%8d%e9%87%8d%e8%a6%81%ef%bc%8c%e4%ba%ba%e5%88%b0%e5%b0%b1%e8%a1%8c.md.html" id="14 策略模式：怎么来不重要，人到就行.md.html">14 策略模式：怎么来不重要，人到就行.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/15%20%e5%91%bd%e4%bb%a4%e6%a8%a1%e5%bc%8f%ef%bc%9a%e5%a4%a7%e9%97%b8%e8%9f%b9%ef%bc%8c%e8%b5%b0%e8%b5%b7%ef%bc%81.md.html" id="15 命令模式：大闸蟹，走起！.md.html">15 命令模式：大闸蟹，走起！.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/16%20%e5%a4%87%e5%bf%98%e6%a8%a1%e5%bc%8f%ef%bc%9a%e5%a5%bd%e8%ae%b0%e6%80%a7%e4%b8%8d%e5%a6%82%e7%83%82%e7%ac%94%e5%a4%b4.md.html" id="16 备忘模式：好记性不如烂笔头.md.html">16 备忘模式：好记性不如烂笔头.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/17%20%e4%ba%ab%e5%85%83%e6%a8%a1%e5%bc%8f%ef%bc%9a%e9%a2%9c%e6%96%99%e5%be%88%e8%b4%b5%e5%bf%85%e9%a1%bb%e5%85%85%e5%88%86%e5%88%a9%e7%94%a8.md.html" id="17 享元模式：颜料很贵必须充分利用.md.html">17 享元模式：颜料很贵必须充分利用.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/18%20%e5%a4%96%e8%a7%82%e6%a8%a1%e5%bc%8f%ef%bc%9a%e5%ad%a6%e5%a6%b9%e5%88%ab%e6%85%8c%ef%bc%8c%e5%ad%a6%e9%95%bf%e5%b8%ae%e4%bd%a0.md.html" id="18 外观模式：学妹别慌，学长帮你.md.html">18 外观模式：学妹别慌，学长帮你.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/19%20%e8%ae%bf%e9%97%ae%e6%a8%a1%e5%bc%8f%ef%bc%9a%e4%b8%80%e5%8d%83%e4%b8%aa%e8%af%bb%e8%80%85%e4%b8%80%e5%8d%83%e4%b8%aa%e5%93%88%e5%a7%86%e9%9b%b7%e7%89%b9.md.html" id="19 访问模式：一千个读者一千个哈姆雷特.md.html">19 访问模式：一千个读者一千个哈姆雷特.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/20%20%e7%94%9f%e6%b4%bb%e4%b8%ad%e7%9a%84%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%ef%bc%9a%e4%b8%8e%e7%bb%8f%e5%85%b8%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e7%9a%84%e4%b8%8d%e8%a7%a3%e6%b8%8a%e6%ba%90.md.html" id="20 生活中的设计模式：与经典设计模式的不解渊源.md.html">20 生活中的设计模式：与经典设计模式的不解渊源.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/21%20%e7%94%9f%e6%b4%bb%e4%b8%ad%e7%9a%84%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%ef%bc%9a%e9%82%a3%e4%ba%9b%e6%9c%aa%e5%ae%8c%e5%be%85%e7%bb%ad%e7%9a%84%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f.md.html" id="21 生活中的设计模式：那些未完待续的设计模式.md.html">21 生活中的设计模式：那些未完待续的设计模式.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/22%20%e6%b7%b1%e5%85%a5%e8%a7%a3%e8%af%bb%e8%bf%87%e6%bb%a4%e5%99%a8%e6%a8%a1%e5%bc%8f%ef%bc%9a%e5%88%b6%e4%bd%9c%e4%b8%80%e6%9d%af%e9%b2%9c%e7%ba%af%e7%bb%86%e8%85%bb%e7%9a%84%e8%b1%86%e6%b5%86.md.html" id="22 深入解读过滤器模式：制作一杯鲜纯细腻的豆浆.md.html">22 深入解读过滤器模式：制作一杯鲜纯细腻的豆浆.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/23%20%e6%b7%b1%e5%85%a5%e8%a7%a3%e8%af%bb%e5%af%b9%e8%b1%a1%e6%b1%a0%e6%8a%80%e6%9c%af%ef%bc%9a%e5%85%b1%e4%ba%ab%e8%ae%a9%e7%94%9f%e6%b4%bb%e6%9b%b4%e4%be%bf%e6%8d%b7.md.html" id="23 深入解读对象池技术：共享让生活更便捷.md.html">23 深入解读对象池技术：共享让生活更便捷.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/24%20%e6%b7%b1%e5%85%a5%e8%a7%a3%e8%af%bb%e5%9b%9e%e8%b0%83%e6%9c%ba%e5%88%b6%ef%bc%9a%e6%8a%8a%e4%bd%a0%e6%8a%80%e8%83%bd%e4%ba%ae%e5%87%ba%e6%9d%a5.md.html" id="24 深入解读回调机制：把你技能亮出来.md.html">24 深入解读回调机制：把你技能亮出来.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/25%20%e8%b0%88%e8%b0%88%e6%88%91%e5%af%b9%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e7%9a%84%e7%90%86%e8%a7%a3.md.html" id="25 谈谈我对设计模式的理解.md.html">25 谈谈我对设计模式的理解.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/26%20%e8%b0%88%e8%b0%88%e6%88%91%e5%af%b9%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99%e7%9a%84%e6%80%9d%e8%80%83.md.html" id="26 谈谈我对设计原则的思考.md.html">26 谈谈我对设计原则的思考.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/%e7%99%bd%e8%af%9d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%2028%20%e8%ae%b2%ef%bc%88%e5%ae%8c%ef%bc%89/27%20%e8%b0%88%e8%b0%88%e6%88%91%e5%af%b9%e9%a1%b9%e7%9b%ae%e9%87%8d%e6%9e%84%e7%9a%84%e7%9c%8b%e6%b3%95.md.html" id="27 谈谈我对项目重构的看法.md.html">27 谈谈我对项目重构的看法.md.html</a>
</li>
<li><a href="/assets/捐赠.md.html">捐赠</a></li>
</ul>
</div>
</div>
<div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseleave="remove_inner()" onmouseover="add_inner()">
<div class="sidebar-toggle-inner"></div>
</div>
<div class="off-canvas-content">
<div class="columns">
<div class="column col-12 col-lg-12">
<div class="book-navbar">
<header class="navbar">
<section class="navbar-section">
<a onclick="open_sidebar()">
<i class="icon icon-menu"></i>
</a>
</section>
</header>
</div>
<div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
<div class="book-post">
<div align="center">因收到Google相关通知，网站将会择期关闭。<a href="https://lumendatabase.org/notices/44265620" target="_blank">相关通知内容</a><hr/></div>
<p align="center" id="tip"></p>
<h1 class="title" data-id="22 深入解读过滤器模式：制作一杯鲜纯细腻的豆浆" id="title">22 深入解读过滤器模式：制作一杯鲜纯细腻的豆浆</h1>
<div><p>故事剧情】</p>
<blockquote>
<p>腊八已过，粥已喝，马上就要过年了！别人家的公司现在都是开年会、发现金红包、发 iPone、发平衡车什么的，而 Tony 什么也没有，只能默默地躲在朋友圈的角落里，好在最后一周还算发了一个慰问品——九阳豆浆机。</p>
<p>豆浆机已经有了，怎么制作一杯鲜纯细腻的豆浆呢？Tony 在网上找了一些资料，摸索了半天总算学会了，准备周末买一些大豆，自制早餐！</p>
<p>把浸泡过的大豆放进机器，再加入半壶水，然后选择模式并按下“启动”键，15 分钟后就可以了，但这并没有完，因为还有最关键的一步，那就是往杯子倒豆浆的时候要用过滤网把豆渣过虑掉。这样，一杯美味的阳光早餐就出来了。</p>
</blockquote>
<p><img alt="img" src="assets/1b943e50-8e53-11e8-80d1-2d51ff7e1c55.jpg"/></p>
<h3 id="用程序来模拟生活">用程序来模拟生活</h3>
<p>世间万物，唯有爱与美食不可辜负，吃的健康才能活的出彩。在上面制作豆浆的过程中，豆浆机很重要，但过滤网更关键，因为它直接影响了豆桨的质量。下面我们用程序来模拟一下这关键的步骤。</p>
<p>源码示例：</p>
<pre><code class="language-python">class FilterScreen:
    """过滤网"""

    def doFilter(self, rawMaterials):
        for material in rawMaterials:
            if (material == "豆渣"):
                rawMaterials.remove(material)
        return rawMaterials

</code></pre>
<p>测试代码：</p>
<pre><code class="language-python">def testFilterScreen():
    rawMaterials = ["豆浆", "豆渣"]
    print("过滤前：", rawMaterials)
    filter = FilterScreen()
    filteredMaterials = filter.doFilter(rawMaterials)
    print("过滤后：", filteredMaterials)

</code></pre>
<p>输出结果：</p>
<pre><code>过滤前： ['豆浆', '豆渣']
过滤后： ['豆浆']

</code></pre>
<h3 id="从剧情中思考过滤器模式">从剧情中思考过滤器模式</h3>
<p>在上面的示例中，豆浆机中有豆浆和豆渣，往杯子里倒的过程中，用过滤网把豆渣过滤掉才能获得更加鲜嫩细腻的豆浆。过滤网起着一个过滤的作用，在程序中也有一种类似的机制，叫<strong>过滤器模式</strong>。</p>
<h4 id="过滤器模式">过滤器模式</h4>
<blockquote>
<p>过滤器模式就是将一组对象，根据某种规则，过滤掉一些不符合要求的对象的过程。</p>
</blockquote>
<p>如在互联网上发布信息时敏感词汇的过滤，在 Web 接口的请求与响应时，对请求和响应信息的过滤。过滤器模式的核心思想非常简单：就是把不需要的信息过滤掉，怎么判定哪些是不需要的信息呢？这就需要制定规则。过滤的过程如下图：</p>
<p><img alt="enter image description here" src="assets/3e919c40-8e53-11e8-80d1-2d51ff7e1c55.jpg"/></p>
<p>举一更加形象的例子，在基建行业中，沙子是最重要的原材料之一，这些沙子很多是从江河中打捞上来的，而打捞上来的不只有沙子，还有小石头和水。若要得到这些颗粒均匀的沙子，就必须把水和石头过滤掉。</p>
<h4 id="与职责模式的联系">与职责模式的联系</h4>
<p>在《[生活中的职责模式——我的假条去哪了]》一文中，我们讲了职责模式（也就是责任链模式）。过滤器与责任链的相似之处是处理过程都是一环一环地进行，不同之处在于责任链中责任的传递一般会有一定的顺序，而过滤器通常没有这种顺序，所以过滤器会比责任链还简单。</p>
<h3 id="过滤器模式的模型抽象">过滤器模式的模型抽象</h3>
<p>一些熟悉 Python 的读者可能会觉得上面示例中的这种写法太麻烦了，Python 本身就自带了 filter() 函数。用下面这段代码就能轻松搞定，结果是一样的，但代码少了好几行：</p>
<pre><code class="language-python">def testFilter():
    rawMaterials = ["豆浆", "豆渣"]
    print("过滤前：", rawMaterials)
    filteredMaterials = list(filter(isSoybeanMilk, rawMaterials))
    print("过滤后：", filteredMaterials)

def isSoybeanMilk(material):
    return material == "豆浆"

</code></pre>
<p>能提出这个问题，说明你是带思考阅读本文的。之所以要这么写，有以下两个原因：</p>
<ul>
<li>Python 自带的 filter() 是函数式编程（即面向过程式的编程），而设计模式讲述的是一种面向对象的设计思想。</li>
<li>filter() 函数只是进行简单的数组中对象的过滤，对于一些更复杂的需求（如对不符合要求的对象，不是过滤掉而是进行替换），filter() 函数是难以应付的。</li>
</ul>
<h4 id="代码框架">代码框架</h4>
<p>基于上面这些问题的思考，我们可以对过滤器模式进行进一步的重构和优化，抽象出过滤器模式的框架模型。</p>
<pre><code class="language-python">from abc import ABCMeta, abstractmethod
# 引入ABCMeta和abstractmethod来定义抽象类和抽象方法

class Filter(metaclass=ABCMeta):
    """过滤器"""

    @abstractmethod
    def doFilter(self, elements):
        """过滤方法"""
        pass

class FilterChain(Filter):
    "过滤器链"

    def __init__(self):
        self._filters = []

    def addFilter(self, filter):
        self._filters.append(filter)

    def removeFilter(self, filter):
        self._filters.remove(filter)

    def doFilter(self, elements):
        for filter in self._filters:
            filter.doFilter(elements)

</code></pre>
<h4 id="类图">类图</h4>
<p>上面的代码框架可用类图表示如下：</p>
<p><img alt="enter image description here" src="assets/4cd24ac0-8e53-11e8-9cd7-51dfc6c66063.jpg"/></p>
<p>Filter 是所有过滤器的抽象类，定义了统一的过滤接口 doFilter()。FilterA 和 FilterB 是具体的过滤器类，一个类定义一个过滤规则。FilterChain 是一个过滤器链，它可以包含多个过滤器，并管理这些过滤器，在过滤对象元素时，包含的每一个过滤器都会进行一次过滤。</p>
<h4 id="基于框架的实现">基于框架的实现</h4>
<p>有了上面的代码框架之后，我们要实现示例代码的功能就会更简单明确了。最开始的示例代码假设它为 version 1.0，那么再看看基于框架的 version 2.0 吧。</p>
<pre><code class="language-python">class FilterScreen(Filter):
    """过滤网"""

    def doFilter(self, elements):
        for material in elements:
            if (material == "豆渣"):
                elements.remove(material)
        return elements

</code></pre>
<p>测试代码不用变。自己跑一下，会发现输出结果和之前的是一样的。</p>
<h4 id="模型说明">模型说明</h4>
<h5 id="设计要点">设计要点</h5>
<p>过滤器模式中主要有三个角色，在设计过滤器模式时要找到并区分这些角色：</p>
<ul>
<li><strong>过滤的目标（Target）：</strong> 即要被过滤的对象，通常是一个对象数组（对象列表）。</li>
<li><strong>过滤器（Filter）：</strong> 负责过滤不需要的对象，一般一个规则对应一个类。</li>
<li><strong>过滤器链（FilterChain）：</strong> 即过滤器的集合，负责管理和维护过滤器，用这个对象进行过滤时，它包含的每一个子过滤器都会进行一次过滤。这个类并不总是需要的，但如果有多个过滤器，有这个类将会带来极大的方便。</li>
</ul>
<h4 id="优缺点">优缺点</h4>
<p>优点：</p>
<ul>
<li>将对象的过滤、校验逻辑抽离出来，降低系统的复杂度。</li>
<li>过滤规则可实现重复利用。</li>
</ul>
<p>缺点：性能较低，每个过滤器都会对每一个元素进行遍历。如果有 n 个元素、m 个过滤器，则复杂度为 O(mn)。</p>
<h3 id="实战应用">实战应用</h3>
<p>我们在互联网上发布信息时，经常被进行敏感词的过滤；在表单提交的信息要以 HTML 的形式进行显示，会对一些特殊字符的进行转换。这时，我们就需要用过滤器模式对提交的信息进行过滤和处理。</p>
<p><strong>源码示例：</strong></p>
<pre><code class="language-python">import re
# 引入正则表达式库

class SensitiveFilter(Filter):
    """敏感词过滤"""

    def __init__(self):
        self.__sensitives = ["黄色", "台独", "贪污"]

    def doFilter(self, elements):
        # 敏感词列表转换成正则表达式
        regex = ""
        for word in self.__sensitives:
            regex += word + "|"
        regex = regex[0: len(regex) - 1]

        # 对每个元素进行过滤
        newElements = []
        for element in elements:
            item, num = re.subn(regex, "", element)
            newElements.append(item)

        return newElements

class HtmlFilter(Filter):
    "HTML特殊字符转换"

    def __init__(self):
        self.__wordMap = {
            "&amp;": "&amp;amp;",
            "'": " &amp;apos;",
            "&gt;": "&amp;gt;",
            "&lt;": "&amp;lt;",
            "\"": " &amp;quot;",
        }

    def doFilter(self, elements):
        newElements = []
        for element in elements:
            for key, value in self.__wordMap.items():
                element = element.replace(key, value)
            newElements.append(element)
        return newElements

</code></pre>
<p><strong>测试代码：</strong></p>
<pre><code class="language-python">def testFiltercontent():
    contents = [
        '有人出售黄色书：&lt;黄情味道&gt;',
        '有人企图搞台独活动, ——"造谣咨询"',
    ]
    print("过滤前的内容：", contents)
    filterChain = FilterChain()
    filterChain.addFilter(SensitiveFilter())
    filterChain.addFilter(HtmlFilter())
    newContents = filterChain.doFilter(contents)
    print("过滤后的内容：", newContents)

</code></pre>
<p><strong>输出结果：</strong></p>
<pre><code>过滤前的内容： ['有人出售黄色书：&lt;黄情味道&gt;', '有人企图搞台独活动, ——"造谣咨询"']
过滤后的内容： ['有人出售书：&amp;lt;黄情味道&amp;gt;', '有人企图搞活动, —— &amp;quot;造谣咨询 &amp;quot;']

</code></pre>
<h3 id="应用场景">应用场景</h3>
<ul>
<li>敏感词过滤、舆情监测。</li>
<li>需要对对象列表（或数据列表）进行检验、审查或预处理的场景。</li>
<li>对网络接口的请求和响应进行拦截，如对每一个请求和响应记录日志，以便日后分析。</li>
</ul>
</div>
</div>
<div>
<div id="prePage" style="float: left">
</div>
<div id="nextPage" style="float: right">
</div>
</div>
</div>
</div>
</div>
<div class="copyright">
<hr/>
<p>© 2019 - 2023 <a href="/cdn-cgi/l/email-protection#355959590c0104040502755258545c591b565a58" target="_blank">Liangliang Lee</a>.
                    Powered by <a href="https://github.com/gin-gonic/gin" target="_blank">gin</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p>
</div>
</div>
<a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9358dc4a4af582e6',t:'MTc0NTUzMTg5MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script src="/static/index.js"></script>
</head></html>