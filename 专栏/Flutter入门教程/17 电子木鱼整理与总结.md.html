<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="zh-cn" http-equiv="content-language"/>
<meta content="17 电子木鱼整理与总结" name="description"/>
<link href="/static/favicon.png" rel="icon"/>
<title>17 电子木鱼整理与总结 </title>
<link href="/static/index.css" rel="stylesheet"/>
<link href="/static/highlight.min.css" rel="stylesheet"/>
<script src="/static/highlight.min.js"></script>
<meta content="Hexo 4.2.0" name="generator"/>
<script data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" defer="" src="https://umami.lianglianglee.com/script.js"></script>
</head>
<body>
<div class="book-container">
<div class="book-sidebar">
<div class="book-brand">
<a href="/">
<img src="/static/favicon.png"/>
<span>技术文章摘抄</span>
</a>
</div>
<div class="book-menu uncollapsible">
<ul class="uncollapsible">
<li><a class="current-tab" href="/">首页</a></li>
<li><a href="../">上一级</a></li>
</ul>
<ul class="uncollapsible">
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/01%20%e5%89%8d%e8%a8%80-%e6%95%99%e7%a8%8b%e5%86%85%e5%ae%b9%e5%af%bc%e8%af%bb.md.html" id="01 前言-教程内容导读.md.html">01 前言-教程内容导读.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/02%20Flutter%20%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e7%9a%84%e6%90%ad%e5%bb%ba.md.html" id="02 Flutter 开发环境的搭建.md.html">02 Flutter 开发环境的搭建.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/03%20%e6%96%b0%e6%89%8b%e6%9d%91%e5%9f%ba%e7%a1%80%20Dart%20%e8%af%ad%e6%b3%95%20%28%e4%b8%8a%29.md.html" id="03 新手村基础 Dart 语法 (上).md.html">03 新手村基础 Dart 语法 (上).md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/04%20%e6%96%b0%e6%89%8b%e6%9d%91%e5%9f%ba%e7%a1%80%20Dart%20%e8%af%ad%e6%b3%95%20%28%e4%b8%8b%29.md.html" id="04 新手村基础 Dart 语法 (下).md.html">04 新手村基础 Dart 语法 (下).md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/05%20Flutter%20%e8%ae%a1%e6%95%b0%e5%99%a8%e9%a1%b9%e7%9b%ae%e8%a7%a3%e8%af%bb.md.html" id="05 Flutter 计数器项目解读.md.html">05 Flutter 计数器项目解读.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/06%20%e7%8c%9c%e6%95%b0%e5%ad%97%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="06 猜数字界面交互与需求分析.md.html">06 猜数字界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/07%20%e4%bd%bf%e7%94%a8%e7%bb%84%e4%bb%b6%e6%9e%84%e5%bb%ba%e9%9d%99%e6%80%81%e7%95%8c%e9%9d%a2.md.html" id="07 使用组件构建静态界面.md.html">07 使用组件构建静态界面.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/08%20%e7%8a%b6%e6%80%81%e6%95%b0%e6%8d%ae%e4%b8%8e%e7%95%8c%e9%9d%a2%e6%9b%b4%e6%96%b0.md.html" id="08 状态数据与界面更新.md.html">08 状态数据与界面更新.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/09%20%e6%a0%a1%e9%aa%8c%e7%bb%93%e6%9e%9c%e4%b8%8e%e6%8f%90%e7%a4%ba%e4%bf%a1%e6%81%af.md.html" id="09 校验结果与提示信息.md.html">09 校验结果与提示信息.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/10%20%e5%8a%a8%e7%94%bb%e4%bd%bf%e7%94%a8%e4%b8%8e%e7%8a%b6%e6%80%81%e5%91%a8%e6%9c%9f.md.html" id="10 动画使用与状态周期.md.html">10 动画使用与状态周期.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/11%20%e7%8c%9c%e6%95%b0%e5%ad%97%e6%95%b4%e7%90%86%e4%b8%8e%e6%80%bb%e7%bb%93.md.html" id="11 猜数字整理与总结.md.html">11 猜数字整理与总结.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/12%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="12 电子木鱼界面交互与需求分析.md.html">12 电子木鱼界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/13%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e9%9d%99%e6%80%81%e7%95%8c%e9%9d%a2%e6%9e%84%e5%bb%ba.md.html" id="13 电子木鱼静态界面构建.md.html">13 电子木鱼静态界面构建.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/14%20%e8%ae%a1%e6%95%b0%e5%8f%98%e5%8c%96%e4%b8%8e%e9%9f%b3%e6%95%88%e6%92%ad%e6%94%be.md.html" id="14 计数变化与音效播放.md.html">14 计数变化与音效播放.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/15%20%e5%bc%b9%e5%87%ba%e9%80%89%e9%a1%b9%e4%b8%8e%e5%88%87%e6%8d%a2%e7%8a%b6%e6%80%81.md.html" id="15 弹出选项与切换状态.md.html">15 弹出选项与切换状态.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/16%20%e7%94%a8%e6%bb%91%e5%8a%a8%e5%88%97%e8%a1%a8%e5%b1%95%e7%a4%ba%e8%ae%b0%e5%bd%95.md.html" id="16 用滑动列表展示记录.md.html">16 用滑动列表展示记录.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/17%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e6%95%b4%e7%90%86%e4%b8%8e%e6%80%bb%e7%bb%93.md.html" id="17 电子木鱼整理与总结.md.html">17 电子木鱼整理与总结.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/18%20%e7%99%bd%e6%9d%bf%e7%bb%98%e5%88%b6%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="18 白板绘制界面交互与需求分析.md.html">18 白板绘制界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/19%20%e8%ae%a4%e8%af%86%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%98%e5%88%b6%e7%bb%84%e4%bb%b6.md.html" id="19 认识自定义绘制组件.md.html">19 认识自定义绘制组件.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/20%20%e9%80%9a%e8%bf%87%e6%89%8b%e5%8a%bf%e5%9c%a8%e7%99%bd%e6%9d%bf%e4%b8%8a%e7%bb%98%e5%88%b6.md.html" id="20 通过手势在白板上绘制.md.html">20 通过手势在白板上绘制.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/21%20%e7%99%bd%e6%9d%bf%e7%94%bb%e7%ac%94%e7%9a%84%e5%8f%82%e6%95%b0%e8%ae%be%e7%bd%ae.md.html" id="21 白板画笔的参数设置.md.html">21 白板画笔的参数设置.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/22%20%e6%92%a4%e9%94%80%e5%8a%9f%e8%83%bd%e4%b8%8e%e7%94%bb%e6%9d%bf%e4%bc%98%e5%8c%96.md.html" id="22 撤销功能与画板优化.md.html">22 撤销功能与画板优化.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/23%20%e5%ba%94%e7%94%a8%e7%95%8c%e9%9d%a2%e6%95%b4%e5%90%88.md.html" id="23 应用界面整合.md.html">23 应用界面整合.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/24%20%e6%95%b0%e6%8d%ae%e7%9a%84%e6%8c%81%e4%b9%85%e5%8c%96%e5%ad%98%e5%82%a8.md.html" id="24 数据的持久化存储.md.html">24 数据的持久化存储.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/25%20%e7%bd%91%e7%bb%9c%e6%95%b0%e6%8d%ae%e7%9a%84%e8%ae%bf%e9%97%ae.md.html" id="25 网络数据的访问.md.html">25 网络数据的访问.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/26%20%e6%95%99%e7%a8%8b%e6%80%bb%e7%bb%93%e4%b8%8e%e5%b1%95%e6%9c%9b.md.html" id="26 教程总结与展望.md.html">26 教程总结与展望.md.html</a>
</li>
<li><a href="/assets/捐赠.md.html">捐赠</a></li>
</ul>
</div>
</div>
<div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseleave="remove_inner()" onmouseover="add_inner()">
<div class="sidebar-toggle-inner"></div>
</div>
<div class="off-canvas-content">
<div class="columns">
<div class="column col-12 col-lg-12">
<div class="book-navbar">
<header class="navbar">
<section class="navbar-section">
<a onclick="open_sidebar()">
<i class="icon icon-menu"></i>
</a>
</section>
</header>
</div>
<div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
<div class="book-post">
<div align="center">因收到Google相关通知，网站将会择期关闭。<a href="https://lumendatabase.org/notices/44265620" target="_blank">相关通知内容</a><hr/></div>
<p align="center" id="tip"></p>
<h1 class="title" data-id="17 电子木鱼整理与总结" id="title">17 电子木鱼整理与总结</h1>
<div><p>通过上面 5 章的学习，我们已经完成了一个简单的电子木鱼小项目。这里将对项目在的一些知识点进行整理和总结，主要从 <strong>界面相关知识</strong> 和 <strong>获得的技能点</strong> 两个方面进行总结：</p>
<p><img alt="image.png" src="assets/7c92429b32ca4a089cd23fd56541812a_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<hr/>
<h4 id="一-界面相关的知识">一、 界面相关的知识</h4>
<p>电子木鱼的界面交互要比猜数字要复杂很多，比如选择切换音效和图片、跳转历史记录界面。所以需要维护的数据以及组件的构建逻辑也更复杂，其中蕴含的知识也就更多。</p>
<h5 id="1-数据模型与界面展示">1. 数据模型与界面展示</h5>
<p>在界面中往往会有一些数据相关性很强，界面构建中需要很多份这样的数据。比如每个木鱼的样式，都有名称、资源、功德范围。这些数据就像一个个豌豆粒，一个个单独维护会非常复杂，把它们封装在一个类中，就相当于让它们住进一个豌豆皮中。</p>
<p><img alt="image.png" src="assets/599da5007079454098cd810b237a7739_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>所以这种对若干个数据进行封装的类型也被形象地称之为 <strong>Bean</strong>，也可以称之为 <strong>数据模型 Model</strong> 。比如这里的 <code>ImageOption</code> 类型就是对木鱼样式数据的封装，一个 <code>ImageOption</code> 对象就对应着界面展示中的一个图片选项。</p>
<pre><code class="language-dart">class ImageOption{
  final String name; // 名称
  final String src; // 资源
  final int min; // 每次点击时功德最小值
  final int max; // 每次点击时功德最大值

  const ImageOption(this.name, this.src, this.min, this.max);
}
</code></pre>
<hr/>
<h5 id="2-组件的封装性">2. 组件的封装性</h5>
<p>还拿木鱼选择的界面来说，可以看出两个木鱼选项的界面结构是完全一样的，只不过是内容数据信息的不同。这时并没有必要写两份构建逻辑，通过一个组件进行封装，界面构建这依赖的数据通过构造中传入。比如这里依赖 <code>ImageOption</code> 和是否激活两个数据：</p>
<p><img alt="image.png" src="assets/d1f0a563e74640898a9649ff4ae8c966_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>封装数据模型类之后，在传参时也更加方便，否则就需要传入一个个的豌豆粒。在构建逻辑中就可以根据传入的数据，构建对应的组件，完成界面展示的任务。</p>
<p><img alt="image.png" src="assets/10f235c7aefc49edbf5670eb99a7d8cc_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>其中 <code>ImageOptionItem</code> 组件也像一个豌豆，里面的豌豆粒就是构建过程中使用的组件。豌豆把豌豆粒包裹在一块，这就是一种现实中的 <strong>封装</strong> 。为 <code>ImageOptionItem</code> 组件提供不同的 <code>ImageOption</code>，就可以展示不同的界面。所以这里只需要准备份数据就行了，而不是重复写两次构建逻辑。</p>
<blockquote>
<p>这就是封装的一大特点： 可复用性。</p>
</blockquote>
<p>复用的目标就是封装的内容，对于组件来说，封装的目标就是构建逻辑。</p>
<pre><code class="language-php">ImageOptionItem(option: option1, active: true),
ImageOptionItem(option: option2, active: false),
</code></pre>
<p>可复用性往往会让使用变得简单，比如 Text 组件是源码提供的组件，它封装了文本渲染的过程。对于使用者来说，只要创建 Text 对象，并不需要理解底层的渲染原理。如果 ImageOptionItem 组件是 A 同学写的，那么把它发给 B 同学，那 B 同学只需要准备数据即可。所以，逻辑一旦封装，也会有 <strong>普适性</strong> : 一人封装，万人可用，这也是类库生态的基石。</p>
<hr/>
<h5 id="3-state-状态类的生命周期回调">3. State 状态类的生命周期回调</h5>
<p>State 的生命周期回调是非常重要的，但对于初学者来说，目前只能先了解这些回调的作用和使用方式。</p>
<ul>
<li>initState 回调方法会在 State 对象创建后被触发一次，可以在其中处理成员对象的初始化逻辑。比如动画控制器创建、音频播放器对象的创建等：</li>
</ul>
<p><img alt="1683987456233.png" src="assets/de8e70bfed2d43ad9784cf72fd84db4e_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<ul>
<li>dispose 回调方法会在 State 对象销毁前触发一次，用于释放一些资源，比如动画控制器、文字控制器、音频播放器等的销毁工作。</li>
</ul>
<p><img alt="image.png" src="assets/566318eea09a480699ca67fe1b3131bb_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<ul>
<li>build 回调方法返回 Widget 对象，也就是组件的构建逻辑。该方法可能在一个 State 对象生命之中可能触发多次，通过 <code>State#setState</code> 方法可以导致 build 方法重新执行。</li>
</ul>
<p><img alt="image.png" src="assets/19ac0519cf384f018d44e8e0e6df037a_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<ul>
<li>didUpdateWidget 会在 State 对应的组件发生变化时被触发；它在一个 State 对象生命之中也可能触发多次。最常见的场合是上层状态类触发 setState，导致组件发生变化，该回调中可以访问到旧的组件，通常会根据新旧组件的配置属性来触发事件，或更新一些状态类内部数据。</li>
</ul>
<p><img alt="image.png" src="assets/7a5fa919df414f4a868de15ddb5c18b5_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>现在只需要会用这四个回调即可，想要完全把握 State 状态类的生命周期回调，需要从源码的角度去理解回调触发的流程。希望之后，你可以在后续的路途上，通过 <a href="https://juejin.cn/book/7084139149673889805/section" target="_blank">《Flutter 渲染机制 - 聚沙成塔》</a> 找到满意的答案。</p>
<hr/>
<h5 id="4-界面的跳转">4. 界面的跳转</h5>
<p>MaterialApp 的内部集成了一套路由体系，在代码中只通过 Navigator.of(context) 来获取 <code>NavigatorState</code> 对象，该对象的 <code>push</code> 方法实现可以跳转界面的功能。下面代码中 <code>MaterialPageRoute</code> 是一个默认的跳转动画界面路由，其中的 <code>builder</code> 方法用来构建跳转到的界面：</p>
<pre><code class="language-scss">Navigator.of(context).push(
  MaterialPageRoute(
    builder: (_) =&gt; RecordHistory(
      records: _records.reversed.toList(),
    ),
  ),
);
</code></pre>
<hr/>
<h4 id="二-技能点">二、 技能点</h4>
<p>在电子木鱼项目中，涉及到了资源的引入，以及使用依赖库。依赖库的存在，极大方便了开发者。你可以轻松地获取和使用别人封装好的代码，来为自己的项目服务，比如这里的音频播放器、uuid 的获取以及日期时间的格式化。</p>
<h5 id="1-资源配置与依赖库的使用">1. 资源配置与依赖库的使用</h5>
<p>Flutter 项目的配置文件是 <code>pubspec.yaml</code> ，其中依赖库配置在 <code>dependencies</code> 节点下。配置之后记得添加一右上角的 <strong>pub get</strong> 按钮获取依赖，或者在根目录下的命令行中输入:</p>
<blockquote>
<p>flutter pub get</p>
</blockquote>
<p><img alt="image.png" src="assets/dfb93a5eeebe4c5c8d69e39c3f81990b_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>获取依赖之后，就可以导入包中的文件，然后使用其中的类或方法：</p>
<pre><code class="language-arduino">import 'package:flame_audio/flame_audio.dart';
</code></pre>
<p>图片、文本等本地资源需要在 flutter 节点下的 <code>asstes</code> 下配置，一般习惯于将资源文件放在项目根目录的 <code>assets</code> 文件夹中。配置时只需要写文件夹，就可以访问期内的所有文件：</p>
<p><img alt="image.png" src="assets/e5a0eb3f2cf04971b9d49ecf0e009092_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<hr/>
<h5 id="2-多种动画变换">2. 多种动画变换</h5>
<p>木鱼在点击时，当前功德文字会以 <strong>缩放+移动+透明度</strong> 动画变化，代码中通过多个 <code>XXXTransition</code> 嵌套实现的。除了这三种，还有些其他的 <code>Transition</code> ，在使用时都需要使用者提供相关类型的动画器:</p>
<p><img alt="image.png" src="assets/b663ca6839c54b6c95e88f268cab97f6_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>这里想强调的是 ： 基于一个动画控制器，可以通过 <code>Tween</code> 来生成其他类型的动画器 Animation ，它们共用一个动力源。也就是说 <code>controller</code> 启动时，这些动画器都会进行动画变化：</p>
<p><img alt="image.png" src="assets/95b7736ca9fa4e249a5a7931d41a503b_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<hr/>
<h5 id="3-短音效的播放">3. 短音效的播放</h5>
<p>flame_audio 插件可以实现音频播放的功能，使用起来也非常简单：通过 <code>FlameAudio.createPool</code> 静态方法，指定资源创建 <code>AudioPool</code> ，执行 <code>start</code> 即可。</p>
<pre><code class="language-ini">AudioPool pool = await FlameAudio.createPool(src, maxPlayers: 1);
pool.start();
</code></pre>
<p>Flutter 中音频播放还有一个 <a href="https://pub.flutter-io.cn/packages/audioplayers" target="_blank">audioplayers</a> 库，其实 <code>flame_audio</code> 是对该库的一个上层封装，引入了缓存池，在播放短音效的场景中更好一些。我也试过 audioplayers ，感觉连续点击短音效有一点杂音，而 flame_audio 表现良好。</p>
<hr/>
<h5 id="4-唯一标识-uuid">4. 唯一标识 uuid</h5>
<p>有些时候，我们需要用一个成员属性来标识对象的唯一性， 一般应用通过 uuid 获取标识符可以视为唯一的。这里使用 <code>uuid</code> 的目的是为每次功德的增加记录提供一个身份标识。</p>
<pre><code class="language-ini">final Uuid uuid = Uuid();
String id = uuid.v4();
</code></pre>
<p>得益于 Flutter 的良好生态环境，像这些基础功能，都已经有了依赖库，所以两行代码就能完成需求。以后有通用的能需要求，可以在 <a href="https://pub.flutter-io.cn/" target="_blank">pub</a> 中看一下有没有依赖库。当然，你有好的功能代码，也可以创建依赖库，提交到 pub 中，供大家一起使用。</p>
<hr/>
<h4 id="三-接触的内置组件">三、接触的内置组件</h4>
<p>最后来整理一下目前电子木鱼项目中用到的 Flutter 内置组件，大家可以根据下表，结合源码以及应用界面，思考一下这些组件的作用和使用方式：</p>
<h5 id="1-基础组件">1. 基础组件</h5>
<table>
<thead>
<tr>
<th>组件名称</th>
<th>功能</th>
<th>猜数字中的使用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Image</td>
<td>图片展示</td>
<td>展示木鱼图片</td>
</tr>
<tr>
<td>GestureDetector</td>
<td>手势事件监听器</td>
<td>监听点击图片事件，处理敲击逻辑</td>
</tr>
<tr>
<td>ElevatedButton</td>
<td>升起按钮</td>
<td>左上角选择音频和木鱼样式和按钮</td>
</tr>
<tr>
<td>ScaleTransition</td>
<td>缩放变换</td>
<td>功德数字缩放动画</td>
</tr>
<tr>
<td>SlideTransition</td>
<td>移动变换</td>
<td>功德数字移动动画</td>
</tr>
<tr>
<td>FadeTransition</td>
<td>透明度变换</td>
<td>功德数字透明度动画</td>
</tr>
<tr>
<td>Material</td>
<td>材料组件</td>
<td>为选择界面提供材料设计默认主题</td>
</tr>
</tbody>
</table>
<hr/>
<h5 id="2-组合结构型">2. 组合结构型</h5>
<table>
<thead>
<tr>
<th>组件名称</th>
<th>功能</th>
<th>猜数字中的使用</th>
</tr>
</thead>
<tbody>
<tr>
<td>ListTile</td>
<td>列表条目通用结构</td>
<td>音频选项以及列表条目</td>
</tr>
</tbody>
</table>
<hr/>
<h5 id="3-布局组件">3. 布局组件</h5>
<table>
<thead>
<tr>
<th>组件名称</th>
<th>功能</th>
<th>猜数字中的使用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Expanded</td>
<td>Row/Column 中延展区域</td>
<td>主页面上下平分区域</td>
</tr>
<tr>
<td>Positioned</td>
<td>Stack 中定位组件</td>
<td>左上角按钮的定位</td>
</tr>
<tr>
<td>Wrap</td>
<td>包裹若干组件</td>
<td>左上角两个按钮的竖直包裹</td>
</tr>
<tr>
<td>Padding</td>
<td>设置内边距</td>
<td>木鱼样式选择界面中的布局</td>
</tr>
<tr>
<td>SizedBox</td>
<td>尺寸设置</td>
<td>选择界面的高度设置</td>
</tr>
<tr>
<td>ListView</td>
<td>滑动列表</td>
<td>历史记录界面</td>
</tr>
</tbody>
</table>
<p>最后想说一下关于木鱼项目的演变：当前项目的功能有点击发声、切换图片、数据记录。其实可以基于此完成另一个小项目，比如电子宠物饲养类型的应用，可以喂食，抚摸发出叫声，切换宠物等操作。这和点击敲木鱼是殊途同归的，有时间和兴趣的可以自己尝试一下。</p>
</div>
</div>
<div>
<div id="prePage" style="float: left">
</div>
<div id="nextPage" style="float: right">
</div>
</div>
</div>
</div>
</div>
<div class="copyright">
<hr>
<p>© 2019 - 2023 <a href="/cdn-cgi/l/email-protection#066a6a6a3f323737363146616b676f6a2865696b" target="_blank">Liangliang Lee</a>.
                    Powered by <a href="https://github.com/gin-gonic/gin" target="_blank">gin</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p>
</hr></div>
</div>
<a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9359ee80381e3ad8',t:'MTc0NTU0MzEyMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script src="/static/index.js"></script>
</head></html>