<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="zh-cn" http-equiv="content-language"/>
<meta content="05 Flutter 计数器项目解读" name="description"/>
<link href="/static/favicon.png" rel="icon"/>
<title>05 Flutter 计数器项目解读 </title>
<link href="/static/index.css" rel="stylesheet"/>
<link href="/static/highlight.min.css" rel="stylesheet"/>
<script src="/static/highlight.min.js"></script>
<meta content="Hexo 4.2.0" name="generator"/>
<script data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" defer="" src="https://umami.lianglianglee.com/script.js"></script>
</head>
<body>
<div class="book-container">
<div class="book-sidebar">
<div class="book-brand">
<a href="/">
<img src="/static/favicon.png"/>
<span>技术文章摘抄</span>
</a>
</div>
<div class="book-menu uncollapsible">
<ul class="uncollapsible">
<li><a class="current-tab" href="/">首页</a></li>
<li><a href="../">上一级</a></li>
</ul>
<ul class="uncollapsible">
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/01%20%e5%89%8d%e8%a8%80-%e6%95%99%e7%a8%8b%e5%86%85%e5%ae%b9%e5%af%bc%e8%af%bb.md.html" id="01 前言-教程内容导读.md.html">01 前言-教程内容导读.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/02%20Flutter%20%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e7%9a%84%e6%90%ad%e5%bb%ba.md.html" id="02 Flutter 开发环境的搭建.md.html">02 Flutter 开发环境的搭建.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/03%20%e6%96%b0%e6%89%8b%e6%9d%91%e5%9f%ba%e7%a1%80%20Dart%20%e8%af%ad%e6%b3%95%20%28%e4%b8%8a%29.md.html" id="03 新手村基础 Dart 语法 (上).md.html">03 新手村基础 Dart 语法 (上).md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/04%20%e6%96%b0%e6%89%8b%e6%9d%91%e5%9f%ba%e7%a1%80%20Dart%20%e8%af%ad%e6%b3%95%20%28%e4%b8%8b%29.md.html" id="04 新手村基础 Dart 语法 (下).md.html">04 新手村基础 Dart 语法 (下).md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/05%20Flutter%20%e8%ae%a1%e6%95%b0%e5%99%a8%e9%a1%b9%e7%9b%ae%e8%a7%a3%e8%af%bb.md.html" id="05 Flutter 计数器项目解读.md.html">05 Flutter 计数器项目解读.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/06%20%e7%8c%9c%e6%95%b0%e5%ad%97%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="06 猜数字界面交互与需求分析.md.html">06 猜数字界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/07%20%e4%bd%bf%e7%94%a8%e7%bb%84%e4%bb%b6%e6%9e%84%e5%bb%ba%e9%9d%99%e6%80%81%e7%95%8c%e9%9d%a2.md.html" id="07 使用组件构建静态界面.md.html">07 使用组件构建静态界面.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/08%20%e7%8a%b6%e6%80%81%e6%95%b0%e6%8d%ae%e4%b8%8e%e7%95%8c%e9%9d%a2%e6%9b%b4%e6%96%b0.md.html" id="08 状态数据与界面更新.md.html">08 状态数据与界面更新.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/09%20%e6%a0%a1%e9%aa%8c%e7%bb%93%e6%9e%9c%e4%b8%8e%e6%8f%90%e7%a4%ba%e4%bf%a1%e6%81%af.md.html" id="09 校验结果与提示信息.md.html">09 校验结果与提示信息.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/10%20%e5%8a%a8%e7%94%bb%e4%bd%bf%e7%94%a8%e4%b8%8e%e7%8a%b6%e6%80%81%e5%91%a8%e6%9c%9f.md.html" id="10 动画使用与状态周期.md.html">10 动画使用与状态周期.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/11%20%e7%8c%9c%e6%95%b0%e5%ad%97%e6%95%b4%e7%90%86%e4%b8%8e%e6%80%bb%e7%bb%93.md.html" id="11 猜数字整理与总结.md.html">11 猜数字整理与总结.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/12%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="12 电子木鱼界面交互与需求分析.md.html">12 电子木鱼界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/13%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e9%9d%99%e6%80%81%e7%95%8c%e9%9d%a2%e6%9e%84%e5%bb%ba.md.html" id="13 电子木鱼静态界面构建.md.html">13 电子木鱼静态界面构建.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/14%20%e8%ae%a1%e6%95%b0%e5%8f%98%e5%8c%96%e4%b8%8e%e9%9f%b3%e6%95%88%e6%92%ad%e6%94%be.md.html" id="14 计数变化与音效播放.md.html">14 计数变化与音效播放.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/15%20%e5%bc%b9%e5%87%ba%e9%80%89%e9%a1%b9%e4%b8%8e%e5%88%87%e6%8d%a2%e7%8a%b6%e6%80%81.md.html" id="15 弹出选项与切换状态.md.html">15 弹出选项与切换状态.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/16%20%e7%94%a8%e6%bb%91%e5%8a%a8%e5%88%97%e8%a1%a8%e5%b1%95%e7%a4%ba%e8%ae%b0%e5%bd%95.md.html" id="16 用滑动列表展示记录.md.html">16 用滑动列表展示记录.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/17%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e6%95%b4%e7%90%86%e4%b8%8e%e6%80%bb%e7%bb%93.md.html" id="17 电子木鱼整理与总结.md.html">17 电子木鱼整理与总结.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/18%20%e7%99%bd%e6%9d%bf%e7%bb%98%e5%88%b6%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="18 白板绘制界面交互与需求分析.md.html">18 白板绘制界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/19%20%e8%ae%a4%e8%af%86%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%98%e5%88%b6%e7%bb%84%e4%bb%b6.md.html" id="19 认识自定义绘制组件.md.html">19 认识自定义绘制组件.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/20%20%e9%80%9a%e8%bf%87%e6%89%8b%e5%8a%bf%e5%9c%a8%e7%99%bd%e6%9d%bf%e4%b8%8a%e7%bb%98%e5%88%b6.md.html" id="20 通过手势在白板上绘制.md.html">20 通过手势在白板上绘制.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/21%20%e7%99%bd%e6%9d%bf%e7%94%bb%e7%ac%94%e7%9a%84%e5%8f%82%e6%95%b0%e8%ae%be%e7%bd%ae.md.html" id="21 白板画笔的参数设置.md.html">21 白板画笔的参数设置.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/22%20%e6%92%a4%e9%94%80%e5%8a%9f%e8%83%bd%e4%b8%8e%e7%94%bb%e6%9d%bf%e4%bc%98%e5%8c%96.md.html" id="22 撤销功能与画板优化.md.html">22 撤销功能与画板优化.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/23%20%e5%ba%94%e7%94%a8%e7%95%8c%e9%9d%a2%e6%95%b4%e5%90%88.md.html" id="23 应用界面整合.md.html">23 应用界面整合.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/24%20%e6%95%b0%e6%8d%ae%e7%9a%84%e6%8c%81%e4%b9%85%e5%8c%96%e5%ad%98%e5%82%a8.md.html" id="24 数据的持久化存储.md.html">24 数据的持久化存储.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/25%20%e7%bd%91%e7%bb%9c%e6%95%b0%e6%8d%ae%e7%9a%84%e8%ae%bf%e9%97%ae.md.html" id="25 网络数据的访问.md.html">25 网络数据的访问.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/26%20%e6%95%99%e7%a8%8b%e6%80%bb%e7%bb%93%e4%b8%8e%e5%b1%95%e6%9c%9b.md.html" id="26 教程总结与展望.md.html">26 教程总结与展望.md.html</a>
</li>
<li><a href="/assets/捐赠.md.html">捐赠</a></li>
</ul>
</div>
</div>
<div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseleave="remove_inner()" onmouseover="add_inner()">
<div class="sidebar-toggle-inner"></div>
</div>
<div class="off-canvas-content">
<div class="columns">
<div class="column col-12 col-lg-12">
<div class="book-navbar">
<header class="navbar">
<section class="navbar-section">
<a onclick="open_sidebar()">
<i class="icon icon-menu"></i>
</a>
</section>
</header>
</div>
<div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
<div class="book-post">
<div align="center">因收到Google相关通知，网站将会择期关闭。<a href="https://lumendatabase.org/notices/44265620" target="_blank">相关通知内容</a><hr/></div>
<p align="center" id="tip"></p>
<h1 class="title" data-id="05 Flutter 计数器项目解读" id="title">05 Flutter 计数器项目解读</h1>
<div><p>通过前面两篇基础语法的学习，已经掌握了 Dart 语言最基础的逻辑控制能力。接下来我们来看一下新建时的默认计数器项目，对项目几个问题进行有一个简单的认知：</p>
<blockquote>
<ol>
<li>界面上的文字是由代码中的何处决定的？</li>
<li>点击按钮时，数字自加和更新界面是如何完成的？</li>
<li>界面中的显示部件是如何布局的？</li>
<li>我们如何修改界面中展示的信息，比如颜色、字体等？</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th>界面显示部件</th>
<th>修改展示信息</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="image.png" src="assets/b0c5ec5bb356406aacb9717dad1c02de_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
<td><img alt="image.png" src="assets/d37c071988b54870900f0848ffb04e72_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
</tr>
</tbody>
</table>
<hr/>
<h4 id="一-代码定位工具">一、代码定位工具</h4>
<p>不管是自己写的代码，还是别人写的，随着代码量的增长，代码的可读性将面临考验。特别是新手朋友，喜欢把所有代码的实现逻辑塞在一块。如何在复杂的代码中找到关键的位置；或如何提纲挈领，将复杂的文字展示出结构性，对编程来说是非常重要的。在看代码之前，有必要先介绍几个快速定位代码的小技巧。</p>
<hr/>
<h5 id="1-全局搜索">1. 全局搜索</h5>
<p>在顶部栏 <code>Edit/Find/Find in Files</code> 打开搜索面板，面板中也可以看到对应的快捷键。如果快捷键没响应，很大可能是和输入法的快捷键冲突了。比如搜狗输入法，禁用其快捷键即可。</p>
<p><img alt="image.png" src="assets/7896736a24b94326955410e50fc967bf_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<hr/>
<p>从视觉上可以看出，界面中有一些固定的文字，这些文字很可能在代码之中。所以全局的搜索是一个很有用的技巧，比如搜索 <code>You have pushed</code> 时，可以找到代码中与之对应的地方：
注:</p>
<p><img alt="image.png" src="assets/0b418d8159814cffab9ba363ac9f47c8_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>在点击之后，就可以跳转到对应的位置，此时光标会在那里闪烁，如下所示：</p>
<p><img alt="image.png" src="assets/90be9e5f947e4b6c865634e2b6126df0_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>当鼠标 <code>悬浮</code> 在上方的文件名上时, 会弹出文件所在的磁盘地址，这样能便于我们找到文件所在：</p>
<p><img alt="image.png" src="assets/b11d9fabacd541e0bd57e3c9c22ff6e5_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>这样就能分析出，界面上展示的信息是由 <code>lib/main.dart</code> 决定的。这就是一个非常基本的 <code>逻辑推理</code> 过程，而整个过程和并不需要用到什么编程知识。相比于推理结果，这种推理的意识更加重要，很多时候初学者都会处于： <strong>我不知道自己该知道什么</strong>，而推理的意识就是在让自己：<strong>我要知道自己想知道什么</strong> 。</p>
<p><img alt="image.png" src="assets/c137dd68582e48b5a93a8addd180ceb3_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<hr/>
<h5 id="2-类结构信息">2. 类结构信息</h5>
<p>当分析一份代码文件时，在 AndroidStudio 中可以打开 <code>Structure</code> 页签，其中会展示出当前文件中的所有类的结构信息，比如成员属性、成员方法等。这样，你可以快速了解这份代码有哪些东西，在点击信息时，也能立刻跳转到对应的代码处：</p>
<p><img alt="image.png" src="assets/530c0c441e8b44ebad9052147a2c5172_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>其中 <code>C</code> 图标表示类，<code>m</code> 图标表示方法， <code>f</code> 图标表示成员属性。当前文件夹中定义了三个类型和一个 main 方法。每个类型中会定义若干方法和属性，其中可以清晰地看出函数的名称、入参和返回值。</p>
<hr/>
<h5 id="3-布局分析">3. 布局分析</h5>
<p>在 <code>Flutter Inspector</code> 页签中，可以看出当前界面的布局结构。点击某项时，会跳转到代码对应的位置，这就是不过展示布局结构，辅助我们快速定位到对应代码位置：</p>
<p><img alt="image.png" src="assets/82fd3a41fd8a465b8ebb93ddefdb948d_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<hr/>
<p>如果布局结构过于复杂，在树中寻找节点也非常麻烦。如果现在已经有了一个项目，运行起来，如何迅速找到界面中的部件，对应代码中的位置呢？ <code>Flutter Inspector</code> 中提供了选择模式，点击下面的图标开启：</p>
<p><img alt="image.png" src="assets/572b6d1b63224047917d393db445d2a9_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>选择模式下，当点击界面上的显示部件，就会自动挑战到对应的代码位置。对于定位代码来说，可谓神器。另外注意一点，点击后左下角会有个搜索按钮，如果想选择其他部件，要先点一下那个搜索按钮：</p>
<table>
<thead>
<tr>
<th>选择模式</th>
<th>选择模式</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="6d3f2cb9b7ae239d7f3df42465bbfba.jpg" src="assets/8a29f49df0664aa3a7e9bd8e78291202_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
<td><img alt="99341641f41be18287b3ce83946f002.jpg" src="assets/f212dd07e858451bbfade80f8bffd919_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
</tr>
</tbody>
</table>
<hr/>
<h4 id="二-计数器代码分析">二、计数器代码分析</h4>
<p>去除注释之后，计数器项目也就 <code>68 行</code> 代码，算是一个非常简单的小项目，但它完成了一个基本的功能交互。可谓麻雀虽小五脏俱全。一开始是 <code>main</code> 方法，表示程序的入口，其中先创建 <code>MyApp</code> 类型对象，并将该对象作为参数传入 <code>runApp</code> 函数中。</p>
<pre><code class="language-csharp">void main() {
  runApp(const MyApp());
}
</code></pre>
<hr/>
<h5 id="1-初见-widget-类型">1. 初见 Widget 类型</h5>
<p><code>MyApp</code> 继承自 <code>StatelessWidget</code> 类，并覆写了其 <code>build</code> 方法，返回 <code>Widget</code> 类型对象；在方法的实现中，创建了 <code>MaterialApp</code> 对象并返回，其中 <code>theme</code> 入参表示主题， 通过 <code>Colors.blue</code> 可以看到蓝色主题的来源。</p>
<p>这时，你可以将 <code>blue</code> 改为 <code>red</code> 然后按 <code>Ctrl+S</code> 进行保存，可以看到界面中的主题变成了红色。这种在开发过程中，不重新启动就可以更新界面的能力，称之为 <strong>热重载 hot reload</strong> 。不用每次都重新编译、启动，这可以大大提升开发的时间效率。</p>
<pre><code class="language-scala">class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: const MyHomePage(title: 'Flutter Demo Home Page'),
    );
  }
}
</code></pre>
<p>决定界面展示的配置信息的类型我们称之为 <strong>组件 Widget</strong>， <code>runApp</code> 方法的入参是 <code>Widget</code> 类型，而 <code>MyApp</code> 可以占位参数，就说明它是 <code>Widget</code> 的派生类；<code>MyApp#build</code> 方法返回的是 <code>Widget</code> 类型，方法实现中实际返回的是 <code>MaterialApp</code> 对象，就说明 <code>MaterialApp</code> 也是 <code>Widget</code> 的派生类。这也是一个简单的逻辑推理过程。</p>
<p>另外 <code>MaterialApp</code> 构造方法的 <code>home</code> 入参，也是需要传入一个 <code>Widget</code> 类型，所以下面的 <code>MyHomePage</code> 也是 <code>Widget</code> 的派生类。从这里可以看出， Flutter 框架中界面的展示和 <code>Widget</code> 一族息息相关。</p>
<hr/>
<h5 id="2-myhomepage-代码分析">2. MyHomePage 代码分析</h5>
<p>从代码中可以看出 <code>MyHomePage</code> 继承自 <code>StatefulWidget</code> , 其中有一个 <code>String</code> 类型的成员属性 <code>title</code>，并在构造时进行赋值。另外，还覆写了 <code>createState</code> 方法，创建 <code>_MyHomePageState</code> 对象并返回。</p>
<pre><code class="language-scala">class MyHomePage extends StatefulWidget {
  const MyHomePage({super.key, required this.title});

  final String title;

  @override
  State&lt;MyHomePage&gt; createState() =&gt; _MyHomePageState();
}
</code></pre>
<p>对于初学者而言，并不需要太关注覆写的方法是何时触发的，应该在意的是它能提供什么功能。就像现实生活中，你学习画画，如果纠结为什么蓝色颜料和黄色颜料混合起来会是绿色，而去研究大量的光学资料、人视觉的成像原理，是本末倒置的。 探索世界(框架)的原理固然重要，但绝不是新手阶段需要做的事，除非你是天赋异禀，或你的目的不是画画，而是科研。</p>
<hr/>
<h5 id="3-myhomepagestate-代码分析">3. <code>_MyHomePageState</code> 代码分析</h5>
<p>上面的 <code>MyApp</code> 和 <code>MyHomePage</code> 两者都是 <code>Widget</code> 的派生类，其中的代码逻辑并不是太复杂，主要是覆写父类方法，完成特定的任务。代码中还剩下一个 <code>_MyHomePageState</code> 类。 从结构上来看，其中有一个整型的 <code>_counter</code> 成员属性；两个成员方法:</p>
<p><img alt="image.png" src="assets/7f1da21d74484c9fa43a6aa4bbb74374_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>从类定义可以看出, <code>_MyHomePageState</code> 继承自 <code>State</code> 类:</p>
<pre><code class="language-scala">class _MyHomePageState extends State&lt;MyHomePage&gt; {
</code></pre>
<hr/>
<p>其中 <code>_incrementCounter</code> 方法中，会让 <code>_counter</code> 变量自加；很明显 <code>_counter</code> 变量就是计数器中展示的数值。而点击按钮时将会触发 <code>_incrementCounter</code>方法完成数值自加：</p>
<pre><code class="language-ini">int _counter = 0;

void _incrementCounter() {
  setState(() {
    _counter++;
  });
}
</code></pre>
<p>最后，就是 <code>_MyHomePageState</code> 中覆写的 <code>build</code> 方法，可以看出界面中的信息是和代码中的内容是对应的。所以，很容易理解代码如何决定界面显示内容。</p>
<p><img alt="image.png" src="assets/46562f81124a470485f4809a1d5be38f_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<blockquote>
<p>动手小实验: 大家可将 <code>_incrementCounter</code> 中的 <code>setState</code> 去掉 (如下)，运行后点击按钮查看效果。将其作为一个对比实验，思考一下 <code>setState</code> 的作用。</p>
</blockquote>
<pre><code class="language-javascript">void _incrementCounter() {
  _counter++;
}
</code></pre>
<hr/>
<h4 id="三-修改界面展示的信息">三、修改界面展示的信息</h4>
<p>到这里，我们已经 <code>感性地</code> 认识了代码如何决定界面的显示。接下来，通过修改界面上的内容，更切身地体验一下，通过代码控制界面展示的感觉。</p>
<hr/>
<h5 id="一-文字的修改">一、文字的修改</h5>
<p>即使没有任何编程基础，也知道代码中的哪些字对应着屏幕中的哪些字，所以修改文字的展示是最简单的。比如现在将屏幕中间的英文改成中文，只需要把字符串换一下即可：</p>
<p><img alt="image.png" src="assets/38c0175e4b714416bf3e229c1dbaf75a_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>这样，在 <code>Ctrl+S</code> 保存之后，界面就会立刻更新：</p>
<p><img alt="image.png" src="assets/9db16e410afc43d9907b633f7a81e78b_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<blockquote>
<p>小练习: 试着把顶部的英文标题改成 <code>计数器</code> 三个字。</p>
</blockquote>
<hr/>
<p>经常玩手机的都知道，界面上文字有着非常多样式可以配置，最常见的就是文字和字号。在计数器的案例中，下面的数字要大很多，从代码中可以看出，区别在于指定了 <code>style</code> 入参。现在我们来尝试修改一下上方文字的大小和颜色：</p>
<p><img alt="image.png" src="assets/23f118060cfc4233944de69d5bec7acd_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>实现方式就是在 <code>Text</code> 对象构造函数中传入 <code>style</code> 参数，参数类型是 <code>TextStyle</code>；除了文字和颜色之外，它还有其他的配置信息，以后可以慢慢了解。</p>
<pre><code class="language-less">const Text(
  '你点击按钮的次数:',
  style: TextStyle(color: Colors.purple, fontSize: 16),
),
</code></pre>
<p>到这里，我们知道了可以通过 <code>Text</code> 对象在屏幕上展示文字信息。</p>
<hr/>
<h5 id="2-查看界面布局的技巧">2.查看界面布局的技巧</h5>
<p>对于布局来说，我们要清楚各个区域占据在屏幕中的哪些位置，就像古代皇帝分封土地，那片区域归谁管，是非常明确的。但初学者在不明白布局组件特性的情况下，很难知晓界面中的 <code>“势力范围”</code>。这时可以通过 <code>Flutter Performance</code> 页签中的按钮来开启 <strong>布局网格辅助</strong> ,来快速了解界面情况：</p>
<p><img alt="image.png" src="assets/69dbc09d0e9441b9a90828602f026564_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>如下所示，在有辅助线的界面中，有哪些 <code>“势力范围”</code> 一清二楚。另外，也可以通过上面介绍的 <strong>选择模式</strong> 来快速定位哪块区域是谁的 <code>“地盘”</code> 。</p>
<table>
<thead>
<tr>
<th>无辅助</th>
<th>有辅助</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="5b24fc4e6fac1af34f4bda584ad81c8.jpg" src="assets/0ade4801fb79472f8d428b99eb7c4f80_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
<td><img alt="3f33fe6b358616691bed87f780f856c.jpg" src="assets/bb726b677a4547c282f25674b30bd614_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
</tr>
</tbody>
</table>
<hr/>
<p>如下，通过选择模式，可以很轻松地知道，中间的区域是 <code>Column</code> 的地盘。代码中的表现是 <code>Column</code> 在构造时将两个文字作为孩子； <code>Column</code> 单词的含义是 <code>列</code> ，它的作用是将若干个子组件竖直排列。</p>
<p><img alt="image.png" src="assets/6acd3c4d8d814c438359286ae3e75f4f_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>其中 <code>Column</code> 在构造时传入的 <code>mainAxisAlignment</code> 入参可以控制子组件在它地盘内的对其方式，比如下面是修改该属性时的表现效果。这里简单了解一下即可，感兴趣的也可以自己尝试一下，就像神农尝百草，了解效力。</p>
<table>
<thead>
<tr>
<th>MainAxisAlignment.start</th>
<th>MainAxisAlignment.spaceBetween</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="9430243f800f50e115faeb681954316.jpg" src="assets/ad4e412c92414dd5ae5cca0f169c2bde_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
<td><img alt="5eb3f6d4210841d4fddc8fb7a3bf97f.jpg" src="assets/c3b4c43ce33645fa9e9cac129489be3d_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
</tr>
</tbody>
</table>
<hr/>
<p>之前说过，在选择模式下，点击树中条目，对选中对于的位置。比如下面点击 <code>Center</code>，就可以看到它的地盘，它的作用是让它地盘中的子组件居中对其；这也是 <code>Column</code> 能在中间的根本原因：</p>
<p><img alt="image.png" src="assets/6505ffd9fa184c418db7cc3dc0f4d392_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<blockquote>
<p>小练习: 试着在代码中去除掉 Center 组件，查看表现效果。</p>
</blockquote>
<p>有了 <strong>布局网格辅助</strong> 和 <strong>选择模式</strong> 两大利器，对于新手认知布局结构是非常友好的。新手应该多多使用它们，逐渐形成布局划分，领域约束的认知，对之后的工作会大有裨益。初始项目代码解读到这里就差不多了，其实这里新手需要关注的只有 <code>mian.dart</code> 中的代码。关于项目中的其他东西，暂时不用理会，专注于一点，更有利于新手的学习，细枝末节的东西，以后可以慢慢了解。最后，留个小练习：</p>
<blockquote>
<p>小练习: 修改代码，使得每次在点击按钮时，数字 + 10</p>
</blockquote>
<hr/>
<h4 id="四-本章小结">四、本章小结</h4>
<p>本章主要结合初始计数器项目的代码，分析一下代码与界面间的关系。同时认识一下 Flutter 最基础的组件概念，通过更改界面的呈现，感性地了解代码中的文字是如何决定界面展示的。</p>
<p>另外，也介绍了 AndroidStudio 中的 <code>Flutter Inspector</code> 和 <code>Flutter Performance</code> 两个界面布局分析的工具；以及 <code>Structure</code> 页签查看当前文件类结构信息。合理地使用工具，可以让你更快地理解和掌握知识。接下来，我们将正式新手村进入第一个小案例 —- 猜数字项目。</p>
</div>
</div>
<div>
<div id="prePage" style="float: left">
</div>
<div id="nextPage" style="float: right">
</div>
</div>
</div>
</div>
</div>
<div class="copyright">
<hr>
<p>© 2019 - 2023 <a href="/cdn-cgi/l/email-protection#640808085d5055555453240309050d084a070b09" target="_blank">Liangliang Lee</a>.
                    Powered by <a href="https://github.com/gin-gonic/gin" target="_blank">gin</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p>
</hr></div>
</div>
<a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9359ece9ef8ac9b5',t:'MTc0NTU0MzA1Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script src="/static/index.js"></script>
</head></html>