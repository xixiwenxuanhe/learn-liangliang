<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="zh-cn" http-equiv="content-language"/>
<meta content="13 电子木鱼静态界面构建" name="description"/>
<link href="/static/favicon.png" rel="icon"/>
<title>13 电子木鱼静态界面构建 </title>
<link href="/static/index.css" rel="stylesheet"/>
<link href="/static/highlight.min.css" rel="stylesheet"/>
<script src="/static/highlight.min.js"></script>
<meta content="Hexo 4.2.0" name="generator"/>
<script data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" defer="" src="https://umami.lianglianglee.com/script.js"></script>
</head>
<body>
<div class="book-container">
<div class="book-sidebar">
<div class="book-brand">
<a href="/">
<img src="/static/favicon.png"/>
<span>技术文章摘抄</span>
</a>
</div>
<div class="book-menu uncollapsible">
<ul class="uncollapsible">
<li><a class="current-tab" href="/">首页</a></li>
<li><a href="../">上一级</a></li>
</ul>
<ul class="uncollapsible">
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/01%20%e5%89%8d%e8%a8%80-%e6%95%99%e7%a8%8b%e5%86%85%e5%ae%b9%e5%af%bc%e8%af%bb.md.html" id="01 前言-教程内容导读.md.html">01 前言-教程内容导读.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/02%20Flutter%20%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e7%9a%84%e6%90%ad%e5%bb%ba.md.html" id="02 Flutter 开发环境的搭建.md.html">02 Flutter 开发环境的搭建.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/03%20%e6%96%b0%e6%89%8b%e6%9d%91%e5%9f%ba%e7%a1%80%20Dart%20%e8%af%ad%e6%b3%95%20%28%e4%b8%8a%29.md.html" id="03 新手村基础 Dart 语法 (上).md.html">03 新手村基础 Dart 语法 (上).md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/04%20%e6%96%b0%e6%89%8b%e6%9d%91%e5%9f%ba%e7%a1%80%20Dart%20%e8%af%ad%e6%b3%95%20%28%e4%b8%8b%29.md.html" id="04 新手村基础 Dart 语法 (下).md.html">04 新手村基础 Dart 语法 (下).md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/05%20Flutter%20%e8%ae%a1%e6%95%b0%e5%99%a8%e9%a1%b9%e7%9b%ae%e8%a7%a3%e8%af%bb.md.html" id="05 Flutter 计数器项目解读.md.html">05 Flutter 计数器项目解读.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/06%20%e7%8c%9c%e6%95%b0%e5%ad%97%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="06 猜数字界面交互与需求分析.md.html">06 猜数字界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/07%20%e4%bd%bf%e7%94%a8%e7%bb%84%e4%bb%b6%e6%9e%84%e5%bb%ba%e9%9d%99%e6%80%81%e7%95%8c%e9%9d%a2.md.html" id="07 使用组件构建静态界面.md.html">07 使用组件构建静态界面.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/08%20%e7%8a%b6%e6%80%81%e6%95%b0%e6%8d%ae%e4%b8%8e%e7%95%8c%e9%9d%a2%e6%9b%b4%e6%96%b0.md.html" id="08 状态数据与界面更新.md.html">08 状态数据与界面更新.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/09%20%e6%a0%a1%e9%aa%8c%e7%bb%93%e6%9e%9c%e4%b8%8e%e6%8f%90%e7%a4%ba%e4%bf%a1%e6%81%af.md.html" id="09 校验结果与提示信息.md.html">09 校验结果与提示信息.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/10%20%e5%8a%a8%e7%94%bb%e4%bd%bf%e7%94%a8%e4%b8%8e%e7%8a%b6%e6%80%81%e5%91%a8%e6%9c%9f.md.html" id="10 动画使用与状态周期.md.html">10 动画使用与状态周期.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/11%20%e7%8c%9c%e6%95%b0%e5%ad%97%e6%95%b4%e7%90%86%e4%b8%8e%e6%80%bb%e7%bb%93.md.html" id="11 猜数字整理与总结.md.html">11 猜数字整理与总结.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/12%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="12 电子木鱼界面交互与需求分析.md.html">12 电子木鱼界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/13%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e9%9d%99%e6%80%81%e7%95%8c%e9%9d%a2%e6%9e%84%e5%bb%ba.md.html" id="13 电子木鱼静态界面构建.md.html">13 电子木鱼静态界面构建.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/14%20%e8%ae%a1%e6%95%b0%e5%8f%98%e5%8c%96%e4%b8%8e%e9%9f%b3%e6%95%88%e6%92%ad%e6%94%be.md.html" id="14 计数变化与音效播放.md.html">14 计数变化与音效播放.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/15%20%e5%bc%b9%e5%87%ba%e9%80%89%e9%a1%b9%e4%b8%8e%e5%88%87%e6%8d%a2%e7%8a%b6%e6%80%81.md.html" id="15 弹出选项与切换状态.md.html">15 弹出选项与切换状态.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/16%20%e7%94%a8%e6%bb%91%e5%8a%a8%e5%88%97%e8%a1%a8%e5%b1%95%e7%a4%ba%e8%ae%b0%e5%bd%95.md.html" id="16 用滑动列表展示记录.md.html">16 用滑动列表展示记录.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/17%20%e7%94%b5%e5%ad%90%e6%9c%a8%e9%b1%bc%e6%95%b4%e7%90%86%e4%b8%8e%e6%80%bb%e7%bb%93.md.html" id="17 电子木鱼整理与总结.md.html">17 电子木鱼整理与总结.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/18%20%e7%99%bd%e6%9d%bf%e7%bb%98%e5%88%b6%e7%95%8c%e9%9d%a2%e4%ba%a4%e4%ba%92%e4%b8%8e%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90.md.html" id="18 白板绘制界面交互与需求分析.md.html">18 白板绘制界面交互与需求分析.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/19%20%e8%ae%a4%e8%af%86%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%98%e5%88%b6%e7%bb%84%e4%bb%b6.md.html" id="19 认识自定义绘制组件.md.html">19 认识自定义绘制组件.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/20%20%e9%80%9a%e8%bf%87%e6%89%8b%e5%8a%bf%e5%9c%a8%e7%99%bd%e6%9d%bf%e4%b8%8a%e7%bb%98%e5%88%b6.md.html" id="20 通过手势在白板上绘制.md.html">20 通过手势在白板上绘制.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/21%20%e7%99%bd%e6%9d%bf%e7%94%bb%e7%ac%94%e7%9a%84%e5%8f%82%e6%95%b0%e8%ae%be%e7%bd%ae.md.html" id="21 白板画笔的参数设置.md.html">21 白板画笔的参数设置.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/22%20%e6%92%a4%e9%94%80%e5%8a%9f%e8%83%bd%e4%b8%8e%e7%94%bb%e6%9d%bf%e4%bc%98%e5%8c%96.md.html" id="22 撤销功能与画板优化.md.html">22 撤销功能与画板优化.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/23%20%e5%ba%94%e7%94%a8%e7%95%8c%e9%9d%a2%e6%95%b4%e5%90%88.md.html" id="23 应用界面整合.md.html">23 应用界面整合.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/24%20%e6%95%b0%e6%8d%ae%e7%9a%84%e6%8c%81%e4%b9%85%e5%8c%96%e5%ad%98%e5%82%a8.md.html" id="24 数据的持久化存储.md.html">24 数据的持久化存储.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/25%20%e7%bd%91%e7%bb%9c%e6%95%b0%e6%8d%ae%e7%9a%84%e8%ae%bf%e9%97%ae.md.html" id="25 网络数据的访问.md.html">25 网络数据的访问.md.html</a>
</li>
<li>
<a class="menu-item" href="/%e4%b8%93%e6%a0%8f/Flutter%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b/26%20%e6%95%99%e7%a8%8b%e6%80%bb%e7%bb%93%e4%b8%8e%e5%b1%95%e6%9c%9b.md.html" id="26 教程总结与展望.md.html">26 教程总结与展望.md.html</a>
</li>
<li><a href="/assets/捐赠.md.html">捐赠</a></li>
</ul>
</div>
</div>
<div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseleave="remove_inner()" onmouseover="add_inner()">
<div class="sidebar-toggle-inner"></div>
</div>
<div class="off-canvas-content">
<div class="columns">
<div class="column col-12 col-lg-12">
<div class="book-navbar">
<header class="navbar">
<section class="navbar-section">
<a onclick="open_sidebar()">
<i class="icon icon-menu"></i>
</a>
</section>
</header>
</div>
<div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
<div class="book-post">
<div align="center">因收到Google相关通知，网站将会择期关闭。<a href="https://lumendatabase.org/notices/44265620" target="_blank">相关通知内容</a><hr/></div>
<p align="center" id="tip"></p>
<h1 class="title" data-id="13 电子木鱼静态界面构建" id="title">13 电子木鱼静态界面构建</h1>
<div><p>下面我们正式开始 <strong>电子木鱼</strong> 小项目的开发，在 <code>lib</code> 下创建一个 <code>muyu</code> 的文件夹，用于存放电子木鱼相关代码文件：</p>
<p><img alt="image.png" src="assets/308b55f922cf4fdab2c9f3666156169f_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<hr/>
<h4 id="1-界面布局分析">1、界面布局分析</h4>
<p>本篇主要完成电子木鱼的主要静态界面的构建、如下所示，分别是界面效果和布局分析效果。从右图可以很轻松地看出界面中的布局情况：</p>
<table>
<thead>
<tr>
<th>界面效果</th>
<th>布局查看</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="3f90ddee05bc97700acb23f0e1f8da3.jpg" src="assets/39ab829539e54a249e57673e2e6e16d6_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
<td><img alt="73bf8cf4a0a9b5b25fcb0c372e9502e.jpg" src="assets/991b6d16f5df4742bc54ac5a9c2e7024_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></td>
</tr>
</tbody>
</table>
<ul>
<li>分为上中下三块，上方是标题、中间是文字和按钮、下方是图片。</li>
<li>整体使用 Scaffold 组件，头部使用 AppBar 组件；主体内容上下平分，可以使用 Column + Expanded 组合。</li>
<li>上半部分的两个绿色按钮，可以通过 Stack + Positioned 组合叠放在右上角。</li>
<li>下半部分通过 Centent + Image 组件让图片居中对其，并通过 GestureDetector 监听点击事件。</li>
</ul>
<hr/>
<h4 id="2-电子木鱼整体界面-muyupage">2. 电子木鱼整体界面 MuyuPage</h4>
<p>电子木鱼在功能上和计数器是非常相似的，只不过是敲击点不同，界面不同不同罢了。由于点击过程中 <code>功德数</code> 会进行变换，使用这里让 <code>MuyuPage</code> 继承自 <code>StatefulWidget</code> ，通过对于的状态类 <code>_MuyuPageState</code> 来维护数据的和界面的构建及更新。</p>
<pre><code class="language-scala">class MuyuPage extends StatefulWidget {
  const MuyuPage({Key? key}) : super(key: key);

  @override
  State&lt;MuyuPage&gt; createState() =&gt; _MuyuPageState();
}
</code></pre>
<p>在 <code>_MuyuPageState</code> 的 <code>build</code> 方法中，对整体界面进行构建。使用 <code>Scaffold</code> 组件提供通用结构，<code>appBar</code> 入参组件确实头部标题栏，一般使用 <code>AppBar</code> 组件。其中有很多配置属性:</p>
<ul>
<li>backgroundColor： 标题栏的背景色。</li>
<li>elevation：标题栏的阴影深度。</li>
<li>titleTextStyle： 标题的文字样式。</li>
<li>iconTheme： 标题栏的图标主题。</li>
<li>actions : 标题栏右侧展示的组件列表。</li>
</ul>
<p>这里说一下 <code>titleTextStyle</code> 和 <code>iconTheme</code> 。 如果直接为 <code>title</code> 中的文字设置样式，直接为 <code>actions</code> 中的图标设置颜色，效果是一样的。但如果 <code>actions</code> 有很多图标按钮，一个个配置就非常麻烦，而使用主题，可以提供默认样式，减少很多重复的操作。</p>
<p><img alt="image.png" src="assets/88d452d902784a69a914978cf9eb593e_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<pre><code class="language-php">class _MuyuPageState extends State&lt;MuyuPage&gt; {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        elevation: 0,
        backgroundColor: Colors.white,
        titleTextStyle: const TextStyle(color: Colors.black,fontSize: 16,fontWeight: FontWeight.bold),,
        iconTheme: const IconThemeData(color: Colors.black),
        title: const Text("电子木鱼"),
        actions: [
          IconButton(onPressed: _toHistory,icon: const Icon(Icons.history))
        ],
      ),
    );
  }

  void _toHistory() {}
}
</code></pre>
<hr/>
<p>主体内容是上下平分区域，可以使用 <code>Column</code> + <code>Expanded</code> 组件。建议再写构建组件代码时，不要塞在一块，适当的通过函数或类进行隔离封装。比如下面代码中，两个部分组件的构建，交给两个方法完成，这样可以让组件构件的条理更清晰，易于阅读和修改。</p>
<pre><code class="language-css">Scaffold(
  // 略同...
  body: Column(
    children: [
      Expanded(child: _buildTopContent()),
      Expanded(child: _buildImage()),
    ],
  ),
)
</code></pre>
<hr/>
<h4 id="3-主体内容的构建">3. 主体内容的构建</h4>
<p>上半部分界面交由 <code>_buildTopContent</code> 方法构建，效果如下： 其中 <code>功德数</code> 文字居中显示；上角有两个按钮，分别用于切换音效和切换图片；按可以通过 <code>ElevatedButton</code> 组件进行展示，并通过 <code>style</code> 入参调节按钮样式。</p>
<p>另外，两个按钮上下排列，可以使用 Column 组件，也可以使用竖直方向的 <code>Wrap</code> 组件。使用 <code>Wrap</code> 组件可以通过 <code>spacing</code> 参数，控制子组件在排列方向上的间距，想比 <code>Column</code> 来说方便一些。</p>
<p><img alt="image.png" src="assets/9ce0c06b5b7b49a7b69ad5a142400cf1_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<pre><code class="language-less">Widget _buildTopContent() {
  // 按钮样式
  final ButtonStyle style = ElevatedButton.styleFrom(
    minimumSize: const Size(36, 36), // 最小尺寸
    padding: EdgeInsets.zero, // 边距
    backgroundColor: Colors.green, // 背景色
    elevation: 0, // 阴影深度
  );

  return Stack(
    children: [
      Center(
        child: Text(
          '功德数: 0',
          style: TextStyle(
            fontSize: 24,
            fontWeight: FontWeight.bold,
          ),
        ),
      ),
      
      Positioned(
          right: 10,
          top: 10,
          child: Wrap(
            spacing: 8,
            direction: Axis.vertical,
            children: [
              ElevatedButton(
                style: style,
                onPressed: () {},
                child: Icon(Icons.music_note_outlined),
              ),
              ElevatedButton(
                style: style,
                onPressed: () {},
                child: Icon(Icons.image),
              )
            ],
          )),
    ],
  );
}
</code></pre>
<hr/>
<p>下半部分界面交由 <code>_buildImage</code> 方法构建，效果如下：是一个居中展示的图片，在 Flutter 中，展示图片可以使用 <code>Image</code> 组件。这里使用 <code>Image.asset</code> 构造函数，从本地资源中加载图片：</p>
<p><img alt="image.png" src="assets/12ebf08b74f14132a878aa36c0556989_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<pre><code class="language-javascript">Widget _buildImage() {
  return Center(
      child: Image.asset(
    'assets/images/muyu.png',
    height: 200, //图片高度
  ));
}
</code></pre>
<p>想要使用本地资源，需要进行配置。一般来说，会在项目中创建一个 <code>assets</code> 文件夹，用于盛放本地资源文件，比如图片、音频、文本等。这里把图片放在 <code>images</code> 文件夹中，如何在 <code>pubspec.yaml</code> 文件的 flutter 节点下配置资源文件夹，这样 <code>images</code> 中的资源就可以使用了。</p>
<p><img alt="image.png" src="assets/aa374da584454f299db69fa36dab85eb_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<p>到这里，我们就已经实现了期望的布局效果，当前代码位置 <a href="https://github.com/toly1994328/flutter_first_station/blob/7d6ac800401777f0ea22e222902b01ef75674c2e/lib/muyu/muyu_page.dart" target="_blank">muyu_page.dart</a> 。从静态界面的构建过程中，不难体会出：这就像通过已经存在的积木，拼组成我们期望的展示效果。</p>
<table>
<thead>
<tr>
<th>界面效果</th>
<th>布局查看</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="3f90ddee05bc97700acb23f0e1f8da3.jpg" src="assets/39ab829539e54a249e57673e2e6e16d6_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75-1711004130215.awebp"/></td>
<td><img alt="73bf8cf4a0a9b5b25fcb0c372e9502e.jpg" src="assets/991b6d16f5df4742bc54ac5a9c2e7024_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75-1711004136246.awebp"/></td>
</tr>
</tbody>
</table>
<hr/>
<h4 id="4-组件的封装">4. 组件的封装</h4>
<p>一个自定义的 <code>Widget</code> ，可以封装一部分界面展示内容的构建逻辑。在开发过程中，我们应该避免让一个 <code>Widget</code> 干所有的事，否则代码会非常杂乱。应该有意识地合理划分结构，将部分的构建逻辑独立出去，以便之后的修改和更新。</p>
<p>当前代码中，通过两个函数来封装上下部分界面的构建逻辑。但函数仍在状态类 <code>_MuyuPageState</code> 中，随着需求的增加，会导致一个类代码会越来越多。我们也可以将界面某部分的构建逻辑，通过自定义 Widget 来分离出去。</p>
<hr/>
<p>这里通过 <code>CountPanel</code> 组件来封装上半部分界面的构建逻辑。可以分析一下，界面在构建过程中需要依赖的数据，并通过构造函数传入数据。其中的构建逻辑和上面的 <code>_buildTopContent</code> 方法一样的。</p>
<p>如果把这些构建逻辑比作一个人，那函数封装和组件封装，就相当于这个人穿了不同的衣服。其内在的本质上并没有太大的差异，只是外部的表现不同罢了。函数封装，在其他的类中，相当于给别人打工；组件封装，有自己的类名，正规编制，相当于自己当老板，经营构建界面逻辑。</p>
<p><img alt="image.png" src="assets/9ce0c06b5b7b49a7b69ad5a142400cf1_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75-1711004147420.awebp"/></p>
<pre><code class="language-scala">class CountPanel extends StatelessWidget {
  final int count;
  final VoidCallback onTapSwitchAudio;
  final VoidCallback onTapSwitchImage;

  const CountPanel({
    super.key,
    required this.count,
    required this.onTapSwitchAudio,
    required this.onTapSwitchImage,
  });
  
  Widget build(BuildContext context) {
    //同上 _buildTopContent 方法
  }
}
</code></pre>
<p>另外，对于组件封装而言，会遇到一些事件的触发。比如这里点击切换音效按钮该做什么，对于 <code>CountPanel</code> 而言是不关心的，它只需要经营好界面的构建逻辑即可。这时可以通过 <strong>回调</strong> 的方式，交由使用者来处理，其实按钮组件的 <code>onPressed</code> 回调入参也是这种思路：</p>
<p><img alt="image.png" src="assets/2ff2601b654c4761970efcdee0979b54_tplv-k3u1fbpfcp-jj-mark_1890_0_0_0_q75.awebp"/></p>
<hr/>
<p>这样，在 <code>_MuyuPageState</code> 中，可以直接使用 <code>CountPanel</code> 完成上半部分的展示，从而减少状态类中的代码量。而 <code>CountPanel</code> 组件的职责也很专一，就更容易做好一件事。</p>
<pre><code class="language-javascript">Expanded(
  child: CountPanel(
    count: 0,
    onTapSwitchAudio: _onTapSwitchAudio,
    onTapSwitchImage: _onTapSwitchImage,
  ),
),

void _onTapSwitchAudio() {}

void _onTapSwitchImage() {}
</code></pre>
<hr/>
<h4 id="5-本章小结">5.本章小结</h4>
<p>本章主要对电子木鱼的静态界面进行搭建，除了学习使用基础组件布局之外，最主要的目的是了解组件对构建逻辑的封装。封装可以自责进行隔离，并在相似的场景中可以复用。</p>
<p>就像皇帝不可能一个人治理整个国家。无法良好地组织和管理各个区域，把所有事交由一个人来做，随着疆域的扩大，早晚会因为臃肿而无法前进，会阻碍社会(应用)的发展。虽然对于新手而言，关注代码的组织方式为时过早，但要有这种意识，避免出现一个掌控所有逻辑的 <strong>上帝类</strong> 。</p>
<blockquote>
<p>小练习: 通过 MuyuAssetsImage 组件封装下半部分的界面构建逻辑。 当前代码位置 <a href="https://github.com/toly1994328/flutter_first_station/tree/66b3a7946a54385fa29f1f9fd5c0d365eaba8430/lib/muyu" target="_blank">muyu</a></p>
</blockquote>
<p>到这里，基本的静态界面就搭建完成了，下一章将处理一下基本的交互逻辑。</p>
</div>
</div>
<div>
<div id="prePage" style="float: left">
</div>
<div id="nextPage" style="float: right">
</div>
</div>
</div>
</div>
</div>
<div class="copyright">
<hr>
<p>© 2019 - 2023 <a href="/cdn-cgi/l/email-protection#e9858585d0ddd8d8d9dea98e84888085c78a8684" target="_blank">Liangliang Lee</a>.
                    Powered by <a href="https://github.com/gin-gonic/gin" target="_blank">gin</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p>
</hr></div>
</div>
<a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9359ee12ddf35980',t:'MTc0NTU0MzEwNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script src="/static/index.js"></script>
</head></html>